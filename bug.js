"use strict";(()=>{var e={};e.id=311,e.ids=[311],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},1017:e=>{e.exports=require("path")},5202:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>c,patchFetch:()=>f,requestAsyncStorage:()=>u,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>p});var n={};r.r(n),r.d(n,{GET:()=>l});var i=r(9303),s=r(8716),o=r(670),a=r(9313);let l=()=>{let e=a.expressions.eval("true");return Response.json(e)},d=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/home/route",pathname:"/api/home",filename:"route",bundlePath:"app/api/home/route"},resolvedPagePath:"/home/flavio/personal/org/data7expressions/labs/3xpr-reproduction-repo/app/api/home/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:u,staticGenerationAsyncStorage:p,serverHooks:h}=d,c="/api/home/route";function f(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:p})}},9951:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionsImpl=void 0;let n=r(8169);class i{constructor(e,t,r,n,i){this.model=e,this.expressionConvert=t,this.operandFacade=r,this.executor=n,this.listener=i}get operatorAlias(){return this.model.operatorAlias}get functionAlias(){return this.model.functionAlias}get operators(){return this.model.operators}get enums(){return this.model.enums}get formats(){return this.model.formats}get constants(){return this.model.constants}get functions(){return this.model.functions}addOperator(e,t,r){this.model.addOperator(t,e,r)}addFunction(e,t,r){this.model.addFunction(e,t,r)}addEnum(e,t){this.model.addEnum(e,t)}addFormat(e,t){this.model.addFormat(e,t)}addConstant(e,t){this.model.addConstant(e,t)}addOperatorAlias(e,t){this.model.addOperatorAlias(e,t)}addFunctionAlias(e,t){this.model.addFunctionAlias(e,t)}addLibrary(e){this.model.addLibrary(e)}getConstantValue(e){return this.model.getConstantValue(e)}getEnumValue(e,t){return this.model.getEnumValue(e,t)}getEnum(e){return this.model.getEnum(e)}getFormat(e){return this.model.getFormat(e)}getOperator(e,t){return this.model.getOperator(e,t)}getFunction(e){return this.model.getFunction(e)}priority(e,t){return this.model.priority(e,t)}isEnum(e){return this.model.isEnum(e)}isConstant(e){return this.model.isConstant(e)}isOperator(e,t){return this.model.isOperator(e,t)}isFunction(e){return this.model.isFunction(e)}get constBuilder(){return this.operandFacade.constBuilder}getBuilder(e){return this.operandFacade.getBuilder(e)}parameters(e){return this.operandFacade.parameters(e)}type(e){return this.operandFacade.type(e)}build(e,t){return this.operandFacade.build(e,t)}clone(e,t){return this.operandFacade.clone(e,t)}eval(e,t){let r=new n.Context(new n.Data(t));return this.executor.eval(e,r)}evalAsync(e,t={}){let r=new n.Context(new n.Data(t));return this.executor.evalAsync(e,r)}execute(e,t={}){let r=new n.Context(new n.Data(t));return this.executor.execute(e,r)}addConvert(e,t){return this.expressionConvert.addConvert(e,t),this}getConvert(e){return this.expressionConvert.getConvert(e)}convert(e,t){return this.expressionConvert.convert(e,t)}subscribe(e){this.listener.subscribe(e)}unsubscribe(e){this.listener.unsubscribe(e)}}t.ExpressionsImpl=i},8442:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(4502),t),i(r(760),t),i(r(9951),t)},5064:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionConvertImp=void 0;class r{constructor(){this.converts={}}addConvert(e,t){return this.converts[e]=t,this}getConvert(e){return this.converts[e]}convert(e,t){let r=this.getConvert(t);if(void 0===r)throw Error(`Converter ${t} not implemented`);return r.convert(e)}}t.ExpressionConvertImp=r},4502:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExecutorImpl=void 0;class r{constructor(e){this.operand=e}eval(e,t){return this.operand.build(e,"expression").eval(t)}async evalAsync(e,t){return this.operand.build(e,"expression").evalAsync(t)}async execute(e,t){return this.operand.build(e,"task").evalAsync(t)}}t.ExecutorImpl=r},760:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExecutorObserveDecorator=void 0;class r{constructor(e){this.executor=e,this.observers=[]}eval(e,t){try{this.beforeExecutionNotify(e,t);let r=this.executor.eval(e,t);return this.afterExecutionNotify(e,t,r),r}catch(r){throw this.errorExecutionNotify(e,t,r),r}}async evalAsync(e,t){try{this.beforeExecutionNotify(e,t);let r=await this.executor.evalAsync(e,t);return this.afterExecutionNotify(e,t,r),r}catch(r){throw this.errorExecutionNotify(e,t,r),r}}async execute(e,t){try{this.beforeExecutionNotify(e,t);let r=await this.executor.execute(e,t);return this.afterExecutionNotify(e,t,r),r}catch(r){throw this.errorExecutionNotify(e,t,r),r}}subscribe(e){this.observers.push(e)}unsubscribe(e){let t=this.observers.indexOf(e);if(-1===t)throw Error("Subject: Nonexistent observer.");this.observers.splice(t,1)}beforeExecutionNotify(e,t){let r={expression:e,context:t};this.observers.forEach(e=>{void 0===e.condition?e.before(r):this.eval(e.condition,t)&&e.before(r)})}afterExecutionNotify(e,t,r){let n={expression:e,context:t,result:r};this.observers.forEach(e=>{void 0===e.condition?e.after(n):this.eval(e.condition,t)&&e.after(n)})}errorExecutionNotify(e,t,r){let n={expression:e,context:t,error:r};this.observers.forEach(e=>{void 0===e.condition?e.error(n):this.eval(e.condition,t)&&e.error(n)})}}t.ExecutorObserveDecorator=r},3121:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7989:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(3121),t)},8142:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionConvertFunction=void 0;let n=r(8169);class i{constructor(e,t){this.operandBuilder=e,this.helper=t}convert(e){if(!e)throw Error("empty lambda function}");let t=this.helper.expression.clearLambda(e),r=this.operandBuilder.build(t);for(;r.type!==n.OperandType.Var;)r.children.length>0&&(r=r.children[0]);if(r.name.includes(".")){let e=r.name.split(".");if(e[0].startsWith("__"))return[t.replace(e[0]+".",""),void 0]}return[t,void 0]}}t.ExpressionConvertFunction=i},4600:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionConvertGraphql=void 0;let n=r(9827);class i{convert(e){return new s(e).parse()}}t.ExpressionConvertGraphql=i;class s{constructor(e){this.buffer=e.split(""),this.length=this.buffer.length,this.index=0,this.expression=[],this.context={}}get end(){return this.index>=this.length}get current(){return this.buffer[this.index]}parse(){return this.read(),[this.expression.join(""),this.context]}read(e=0,t="",r=""){for(;!this.end;){let n=this.getName();if(this.expression.push(r+n),this.forwardSpaces(),this.current===t){this.index+=1;break}"{"===this.current?(this.index+=1,this.expression.push(0===e?".map(p=> [":".include(p=> ["),this.read(e+1,"}","p."),this.expression.push("])")):"("===this.current&&this.readArgs(")"),this.end||this.expression.push(",")}}readArgs(e=""){}getName(e=!0){let t=[];if(e)for(;!this.end&&n.h3lp.val.isAlphanumeric(this.current);)t.push(this.current),this.index+=1;else{let e=this.index;for(;!this.end&&n.h3lp.val.isAlphanumeric(this.buffer[e]);)t.push(this.buffer[e]),e+=1}return t.join("")}forwardSpaces(){for(;!this.end&&" "===this.buffer[this.index];)this.index+=1}}},8293:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionsBuilder=void 0;let n=r(3716),i=r(8442),s=r(5064),o=r(6899),a=r(8142),l=r(4600),d=r(300);class u{constructor(e){this.helper=e}build(){let e=new o.ModelServiceImpl,t=new d.OperandFacadeBuilder(e,this.helper).build(),r=new s.ExpressionConvertImp().addConvert("function",new a.ExpressionConvertFunction(t.getBuilder("expression"),this.helper)).addConvert("graphql",new l.ExpressionConvertGraphql);new n.CoreLibrary(t.getBuilder("expression"),t,this.helper).load(e);let u=new i.ExecutorObserveDecorator(new i.ExecutorImpl(t));return new i.ExpressionsImpl(e,r,t,u,u)}}t.ExpressionsBuilder=u},506:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionHelper=void 0;class r{constructor(e){this.str=e}clearLambda(e){let t=e.toString().trim(),r=t.indexOf("=>")+2;if((r=(t=t.substring(r,t.length).trim()).indexOf("("))>-1){let e=t.substring(0,r).trim().split(".");if(e.length>2)return this.str.replace(t,e[0]+".","")}else{let e=t.split(".");if(e.length>1)return this.str.replace(t,e[0]+".","")}return t}}t.ExpressionHelper=r},7943:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(506),t)},3716:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreLibrary=void 0;let n=r(8169),i=r(5051);class s{constructor(e,t,r){this.builder=e,this.cloner=t,this.helper=r}load(e){this.constants(e),this.enums(e),this.formats(e),this.operators(e),this.generalFunctions(e),this.comparisonFunctions(e),this.nullFunctions(e),this.numberFunctions(e),this.stringFunctions(e),this.arrayFunctions(e),this.groupFunctions(e),this.dateTimeFunctions(e),this.conversionFunctions(e),this.setsFunctions(e)}constants(e){e.addConstant("true",!0),e.addConstant("false",!1),e.addConstant("null",null)}enums(e){e.addEnum("DayOfWeek",[["Sunday",0],["Monday",1],["Tuesday",2],["Wednesday",3],["Thursday",4],["Friday",5],["Saturday",6]])}formats(e){e.addFormat("email","^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$"),e.addFormat("integer","^\\d+$"),e.addFormat("decimal","^\\d+\\.\\d+$"),e.addFormat("string","^[a-zA-Z0-9_.]+$"),e.addFormat("date","^\\d{4}-\\d{2}-\\d{2}$"),e.addFormat("dateTime","\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d:[0-5]\\d\\.\\d+([+-][0-2]\\d:[0-5]\\d|Z)"),e.addFormat("time","\\[0-2]\\d:[0-5]\\d:[0-5]\\d")}operators(e){e.addOperator("+(a:T,b:T):T",(e,t)=>e+t,{priority:5,description:"Addition"}),e.addOperator("-(a:number,b:number):number",(e,t)=>e-t,{priority:5,description:"Subtraction"}),e.addOperator("-(a:number):number",e=>-1*e,{priority:9,description:"Negation"}),e.addOperator("*(a:number,b:number):number",(e,t)=>e*t,{priority:6,description:"Multiplication"}),e.addOperator("/(a:number,b:number):number",(e,t)=>e/t,{priority:6,description:"Division"}),e.addOperator("**(a:number,b:number):number",(e,t)=>e**t,{priority:7,description:"Exponentiation"}),e.addOperator("//(a:number,b:number):number",(e,t)=>Math.pow(e,1/t),{priority:7,description:"Root"}),e.addOperator("%(a:number,b:number):number",(e,t)=>e%t,{priority:8,description:"Modulus"}),e.addOperator("&(a:number,b:number):number",(e,t)=>e&t,{priority:5,description:"Bitwise AND"}),e.addOperator("|(a:number,b:number):number",(e,t)=>e|t,{priority:5,description:"Bitwise OR"}),e.addOperator("^(a:number,b:number):number",(e,t)=>e^t,{priority:5,description:"Bitwise XOR"}),e.addOperator("~(a:number):number",e=>~e,{priority:9,description:"Bitwise NOT"}),e.addOperator("<<(a:number,b:number):number",(e,t)=>e<<t,{priority:5,description:"Bitwise Left Shift"}),e.addOperator(">>(a:number,b:number):number",(e,t)=>e>>t,{priority:5,description:"Bitwise Right Shift"}),e.addOperator("==(a:T,b:T):boolean",(e,t)=>e===t,{priority:4,description:"Equality"}),e.addOperatorAlias("===","=="),e.addOperator("!=(a:T,b:T):boolean",(e,t)=>e!==t,{priority:4,description:"Inequality"}),e.addOperatorAlias("!==","!="),e.addOperatorAlias("<>","!="),e.addOperator(">(a:T,b:T):boolean",(e,t)=>e>t,{priority:4,description:"Greater than"}),e.addOperator("<(a:T,b:T):boolean",(e,t)=>e<t,{priority:4,description:"Less than"}),e.addOperator(">=(a:T,b:T):boolean",(e,t)=>e>=t,{priority:4,description:"Greater than or equal"}),e.addOperator("<=(a:T,b:T):boolean",(e,t)=>e<=t,{priority:3,description:"Less than or equal"}),e.addOperator("&&(a:boolean,b:boolean):boolean",new o,{priority:3,description:"Logical AND"}),e.addOperator("||(a:boolean,b:boolean):boolean",new a,{priority:3,description:"Logical OR"}),e.addOperator("!(a:boolean):boolean",e=>!e,{priority:5,description:"Logical NOT"}),e.addOperator("[](list:T[],index:any):T",(e,t)=>e[t],{priority:2,description:"Index"}),e.addOperator("$(name:string):string",e=>process.env[e],{priority:9,description:"Environment Variable"}),e.addOperator("=(a:T,b:T):T",new l,{priority:1,description:"Assignment"}),e.addOperator("+=(a:number,b:number):number",new d,{priority:1,description:"Assignment Addition"}),e.addOperator("-=(a:number,b:number):number",new u,{priority:1,description:"Assignment Subtraction"}),e.addOperator("*=(a:number,b:number):number",new p,{priority:1,description:"Assignment Multiplication"}),e.addOperator("/=(a:number,b:number):number",new h,{priority:1,description:"Assignment Division"}),e.addOperator("**=(a:number,b:number):number",new c,{priority:1,description:"Assignment Exponentiation"}),e.addOperator("//=(a:number,b:number):number",new f,{priority:1,description:"Assignment Floor Division"}),e.addOperator("%=(a:number,b:number):number",new v,{priority:1,description:"Assignment Modulus"}),e.addOperator("&=(a:number,b:number):number",new y,{priority:1,description:"Assignment Bitwise AND"}),e.addOperator("|=(a:number,b:number):number",new m,{priority:1,description:"Assignment Bitwise OR"}),e.addOperator("^=(a:number,b:number):number",new g,{priority:1,description:"Assignment Bitwise XOR"}),e.addOperator("<<=(a:number,b:number):number",new b,{priority:1,description:"Assignment Bitwise Left Shift"}),e.addOperator(">>=(a:number,b:number):number",new w,{priority:1,description:"Assignment Bitwise Right Shift"})}generalFunctions(e){e.addFunction("sleep(ms?: number):void",async(e=0)=>new Promise(t=>setTimeout(t,e)),{async:!0,description:"Sleeps for the specified number of milliseconds"}),e.addFunction("console(value:any):void",e=>{console.log("object"==typeof e?JSON.stringify(e):e)},{description:"Prints to console"})}nullFunctions(e){e.addFunction("nvl(value:T, default:T):T",(e,t)=>this.helper.utils.nvl(e,t),{description:"Null value"}),e.addFunction("nvl2(value:any, a:T,b:T):T",(e,t,r)=>this.helper.utils.nvl2(e,t,r),{description:"Null value"})}comparisonFunctions(e){e.addFunction("between(value:T,from:T,to:T):boolean",(e,t,r)=>this.helper.val.between(e,t,r),{description:"Between"}),e.addFunction("includes(source:string|T[],value:string|T):boolean",(e,t)=>!!e&&!!t&&e.includes(t),{description:"Includes"}),e.addFunctionAlias("contains","includes"),e.addFunction("in(source:T,...values:T):boolean",(e,...t)=>void 0!==e&&void 0!==t&&(1===t.length&&Array.isArray(t)?t[0].includes(e):t.includes(e)),{description:"In"}),e.addFunction("like(value:string,pattern:string):boolean",(e,t)=>!!e&&!!t&&e.includes(t),{description:"String contains pattern"}),e.addFunction("isNull(value:any):boolean",e=>this.helper.val.isNull(e),{description:"Check if value is null"}),e.addFunction("isNotNull(value:any):boolean",e=>this.helper.val.isNotNull(e),{description:"Check if value is not null"}),e.addFunction("isEmpty(value:string):boolean",e=>this.helper.val.isEmpty(e),{description:"Check if value is empty"}),e.addFunction("isNotEmpty(value:string):boolean",e=>this.helper.val.isNotEmpty(e),{description:"Check if value is not empty"}),e.addFunction("isBoolean(value:any):boolean",e=>this.helper.val.isBoolean(e),{description:"Check if value is boolean"}),e.addFunction("isNumber(value:any):boolean",e=>this.helper.val.isNumber(e),{description:"Check if value is number"}),e.addFunction("isInteger(value:any):boolean",e=>this.helper.val.isInteger(e),{description:"Check if value is integer"}),e.addFunction("isDecimal(value:any):boolean",e=>this.helper.val.isDecimal(e),{description:"Check if value is decimal"}),e.addFunction("isString(value:any):boolean",e=>this.helper.val.isString(e),{description:"Check if value is string"}),e.addFunction("isDate(value:any):boolean",e=>this.helper.val.isDate(e),{description:"Check if value is date"}),e.addFunction("isDateTime(value:any):boolean",e=>this.helper.val.isDateTime(e),{description:"Check if value is date time"}),e.addFunction("isTime(value:any):boolean",e=>this.helper.val.isTime(e),{description:"Check if value is time"}),e.addFunction("isObject(value:any):boolean",e=>this.helper.val.isObject(e),{description:"Check if value is object"}),e.addFunction("isArray(value:any):boolean",e=>this.helper.val.isArray(e),{description:"Check if value is array"}),e.addFunction("isBooleanFormat(value:string):boolean",e=>this.helper.val.isBooleanFormat(e),{description:"Check if value is boolean format"}),e.addFunction("isNumberFormat(value:string):boolean",e=>this.helper.val.isNumberFormat(e),{description:"Check if value is number format"}),e.addFunction("isIntegerFormat(value:string):boolean",e=>this.helper.val.isIntegerFormat(e),{description:"Check if value is integer format"}),e.addFunction("isDecimalFormat(value:string):boolean",e=>this.helper.val.isDecimalFormat(e),{description:"Check if value is decimal format"}),e.addFunction("isDateFormat(value:string):boolean",e=>this.helper.val.isDateFormat(e),{description:"Check if value is date format"}),e.addFunction("isDateTimeFormat(value:string):boolean",e=>this.helper.val.isDateTimeFormat(e),{description:"Check if value is date time format"}),e.addFunction("isTimeFormat(value:string):boolean",e=>this.helper.val.isTimeFormat(e),{description:"Check if value is time format"})}numberFunctions(e){e.addFunction("abs(x:number):number",Math.abs,{description:"Absolute value"}),e.addFunction("acos(x:number):number",Math.acos,{description:"Arc cosine"}),e.addFunction("asin(x:number):number",Math.asin,{description:"Arc sine"}),e.addFunction("atan(x:number):number",Math.atan,{description:"Arc tangent"}),e.addFunction("atan2(x:number):number",Math.atan2,{description:"Arc tangent of two variables"}),e.addFunction("ceil(x:number):number",Math.ceil,{description:"Ceiling"}),e.addFunction("cos(x:number):number",Math.cos,{description:"Cosine"}),e.addFunction("cosh(x:number):number",Math.cosh,{description:"Hyperbolic cosine"}),e.addFunction("exp(x:number):number",Math.exp,{description:"Exponential"}),e.addFunction("floor(x:number):number",Math.floor,{description:"Floor"}),e.addFunction("ln(x:number):number",Math.log,{description:"Natural logarithm"}),e.addFunction("log10(x:number):number",Math.log10,{description:"Base 10 logarithm"}),e.addFunction("log(x:number):number",Math.log,{description:"Natural logarithm"}),e.addFunction("remainder(n1:number,n2:number):number",(e,t)=>e%t,{description:"Remainder"}),e.addFunction("round(num:number,decimals=0):number",(e,t=0)=>t>0?Number(e.toFixed(t)):Math.round(e),{description:"Round"}),e.addFunction("sign(x:number):number",Math.sign,{description:"Sign"}),e.addFunction("sin(x:number):number",Math.sin,{description:"Sine"}),e.addFunction("sinh(x:number):number",Math.sinh,{description:"Hyperbolic sine"}),e.addFunction("tan(x:number):number",Math.tan,{description:"Tangent"}),e.addFunction("tanh(x:number):number",Math.tanh,{description:"Hyperbolic tangent"}),e.addFunction("trunc(x:number):number",Math.trunc,{description:"Truncate"})}conversionFunctions(e){e.addFunction("toString(value:any):string",e=>this.helper.str.toString(e),{description:"Convert to string"}),e.addFunction("toNumber(value:any):number",e=>this.helper.utils.toNumber(e),{description:"Convert to number"}),e.addFunction("dateToString(date:date):string",e=>"string"==typeof e?new Date(e).toISOString():e.toISOString(),{description:"Convert date to string"}),e.addFunction("stringify(value:any):string",e=>JSON.stringify(e),{description:"Convert to JSON string"}),e.addFunction("parse(value:string):any",e=>JSON.parse(e),{description:"Parse JSON string"}),e.addFunction("keys(obj: any):string[]",e=>"object"==typeof e?Object.keys(e):[],{description:"Object keys"}),e.addFunction("values(obj: any):any[]",e=>"object"==typeof e?Object.values(e):[],{description:"Object values"}),e.addFunction("entries(obj: any):[string,any][]",e=>"object"==typeof e?Object.entries(e):[],{description:"Object entries"}),e.addFunction("fromEntries(entries: [string,any][]): any",e=>this.helper.obj.fromEntries(e),{description:"Object from entries"})}stringFunctions(e){e.addFunction("chr(ascii: number):string",e=>String.fromCharCode(e),{description:"Character"}),e.addFunction("capitalize(value:string):string",e=>this.helper.str.capitalize(e),{description:"Capitalize"}),e.addFunction("endsWith(value:string, sub:string, start:number):boolean",(e,t,r)=>e.endsWith(t,r),{description:"Ends with"}),e.addFunction("strCount(source: string, value: string):number",(e,t)=>e.split(t).length-1,{description:"Count"}),e.addFunction("lower(value: string):string",e=>e.toLowerCase(),{description:"Lower case"}),e.addFunction("lpad(value: string, len: number, pad: string):string",(e,t,r)=>e.padStart(t,r),{description:"Left pad"}),e.addFunction("ltrim(value: string):string",e=>e.trimStart(),{description:"Left trim"}),e.addFunction("indexOf(value:string, sub:string, start:number):number",(e,t,r)=>e.indexOf(t,r),{description:"Index of"}),e.addFunction('join(values:string[],separator:string=","):string',(e,t=",")=>e.join(t),{description:"Join"}),e.addFunction("replace(value: string, source: string, target: string):string",(e,t,r)=>this.helper.str.replace(e,t,r),{description:"Replace"}),e.addFunction("rpad(value: string, len: number, pad: string):string",(e,t,r)=>e.padEnd(t,r),{description:"Right pad"}),e.addFunction("rtrim(value: string):string",e=>e.trimEnd(),{description:"Right trim"}),e.addFunction("substring(value: string, from: number, count: number):string",(e,t,r)=>e.substring(t,r),{description:"Substring"}),e.addFunctionAlias("substr","substring"),e.addFunction("trim(value: string):string",e=>e.trim(),{description:"Trim"}),e.addFunction("upper(value: string):string",e=>e.toUpperCase(),{description:"Upper case"}),e.addFunction("concat(...values:any):string",(...e)=>this.helper.str.concat(e),{description:"Concatenate"}),e.addFunctionAlias("concatenate","concat"),e.addFunction("test(value: string, regexp: string):boolean",(e,t)=>new RegExp(t).test(e),{description:"Test"}),e.addFunction("title(value:string):string",e=>this.helper.str.initCap(e),{description:"Title case"}),e.addFunction("match(value: string, regexp: string):any",(e,t)=>e?e.match(t):null,{description:"Match"}),e.addFunction("mask(value: string):string",e=>e?e.length>8?e.substring(0,3)+"*****"+e.substring(e.length-3,e.length):e.length>5?e.substring(0,1)+"*****"+e.substring(e.length-1,e.length):"*":e,{description:"Mask sensitive data"}),e.addFunction('split(value:string,separator:string=","):string[]',(e,t=",")=>e.split(t),{description:"Split string"}),e.addFunction("startWith(value:string, sub:string, start:number):boolean",(e,t,r)=>e.startsWith(t,r),{description:"Starts with"}),e.addFunctionAlias("startsWith","startWith")}dateTimeFunctions(e){e.addFunction("curTime():time",()=>{let e=new Date;return e.getHours()+":"+(e.getMinutes()+1)+":"+e.getSeconds()},{description:"Current time"}),e.addFunction("today():date",()=>{let e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},{description:"Current date"}),e.addFunction("now():dateTime",()=>new Date().toISOString(),{description:"Current date time"}),e.addFunction("time(value: string):time",e=>{let t=new Date(e);return t.getHours()+":"+(t.getMinutes()+1)+":"+t.getSeconds()},{description:"Get time"}),e.addFunction("date(value: string):date",e=>{let t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},{description:"Get date"}),e.addFunction("dateTime(value: string):dateTime",e=>new Date(e).toISOString(),{description:"Get date time"}),e.addFunction("year(value: dateTime):integer",e=>new Date(e).getFullYear(),{description:"Get year"}),e.addFunction("month(value: dateTime):integer",e=>new Date(e).getMonth()+1,{description:"Get month"}),e.addFunction("day(value: dateTime):integer",e=>new Date(e).getDate(),{description:"Get day"}),e.addFunction("weekday(value: dateTime):integer",e=>new Date(e).getDay(),{description:"Get day of week"}),e.addFunction("hour(value: dateTime):integer",e=>new Date(e).getHours(),{description:"Get hours"}),e.addFunction("minute(value: dateTime):integer",e=>new Date(e).getMinutes(),{description:"Get minutes"}),e.addFunction("second(value: dateTime):integer",e=>new Date(e).getSeconds(),{description:"Get seconds"}),e.addFunction("millisecond(value: dateTime):integer",e=>new Date(e).getMilliseconds(),{description:"Get milliseconds"}),e.addFunction("addYear(date: dateTime, value: number):dateTime",(e,t)=>{let r=new Date(e);return r.setFullYear(r.getFullYear()+t),r.toISOString()},{description:"Add years"}),e.addFunction("addMonth(date: dateTime, value: number):dateTime",(e,t)=>{let r=new Date(e);return r.setMonth(r.getMonth()+t),r.toISOString()},{description:"Add months"}),e.addFunction("addDay(date: dateTime, value: number):dateTime",(e,t)=>{let r=new Date(e);return r.setDate(r.getDate()+t),r.toISOString()},{description:"Add days"}),e.addFunction("addHour(date: dateTime, value: number):dateTime",(e,t)=>{let r=new Date(e);return r.setHours(r.getHours()+t),r.toISOString()},{description:"Add hours"}),e.addFunction("addMinute(date: dateTime, value: number):dateTime",(e,t)=>{let r=new Date(e);return r.setMinutes(r.getMinutes()+t),r.toISOString()},{description:"Add minutes"}),e.addFunction("addSecond(date: dateTime, value: number):dateTime",(e,t)=>{let r=new Date(e);return r.setSeconds(r.getSeconds()+t),r.toISOString()},{description:"Add seconds"}),e.addFunction("addMillisecond(date: dateTime, value: number):dateTime",(e,t)=>{let r=new Date(e);return r.setMilliseconds(r.getMilliseconds()+t),r.toISOString()},{description:"Add milliseconds"}),e.addFunction("addTime(date: dateTime, time: time):dateTime",(e,t)=>{let r=new Date("2000-01-01T"+t),n=new Date(e);return n.setHours(n.getHours()+r.getHours()),n.setMinutes(n.getMinutes()+r.getMinutes()),n.setSeconds(n.getSeconds()+r.getSeconds()),n.setMilliseconds(n.getSeconds()+r.getMilliseconds()),n.toISOString()},{description:"Add time"}),e.addFunction("subtractTime(date: dateTime, time: time):dateTime",(e,t)=>{let r=new Date("2000-01-01T"+t),n=new Date(e);return n.setHours(n.getHours()-r.getHours()),n.setMinutes(n.getMinutes()-r.getMinutes()),n.setSeconds(n.getSeconds()-r.getSeconds()),n.setMilliseconds(n.getSeconds()-r.getMilliseconds()),n.toISOString()},{description:"Subtract time"}),e.addFunction("yearDiff(date1: dateTime, date2: dateTime):integer",(e,t)=>{let r=new Date(e);return Math.abs(new Date(t).getFullYear()-r.getFullYear())},{description:"Year difference"}),e.addFunction("dayDiff(date1: dateTime, date2: dateTime):integer",(e,t)=>{let r=new Date(e),n=new Date(t);return Math.floor((r.getTime()-n.getTime())/864e5)},{description:"Day difference"}),e.addFunction("hourDiff(date1: dateTime, date2: dateTime):integer",(e,t)=>{let r=new Date(e),n=new Date(t);return Math.floor((r.getTime()-n.getTime())/36e5)},{description:"Hour difference"}),e.addFunction("secondDiff(date1: dateTime, date2: dateTime):integer",(e,t)=>{let r=new Date(e),n=new Date(t);return Math.floor((r.getTime()-n.getTime())/1e3)},{description:"Second difference"}),e.addFunction("millisecondDiff(date1: dateTime, date2: dateTime):integer",(e,t)=>{let r=new Date(e),n=new Date(t);return Math.floor(r.getTime()-n.getTime())},{description:"Millisecond difference"}),e.addFunction("dayToDate(value: number):dateTime",e=>new Date(864e5*e).toISOString(),{description:"Convert days to date time"}),e.addFunction("hourToDate(value: number):dateTime",e=>new Date(36e5*e).toISOString(),{description:"Convert hours to date time"}),e.addFunction("secondToDate(value: number):dateTime",e=>new Date(1e3*e).toISOString(),{description:"Convert seconds to date time"}),e.addFunction("millisecondToDate(value: number):dateTime",e=>new Date(e).toISOString(),{description:"Convert milliseconds to date time"})}arrayFunctions(e){e.addFunction("map(list: any[], predicate: T):T[]",new O(this.builder,this.cloner,this.helper),{description:"Map"}),e.addFunctionAlias("select","map"),e.addFunction("foreach(list: any[], predicate: any):void",new x,{description:"Foreach"}),e.addFunctionAlias("each","foreach"),e.addFunction("filter(list: T[], predicate: boolean):T[]",new E,{description:"Filter"}),e.addFunctionAlias("where","filter"),e.addFunction("reverse(list: T[], predicate: any):T[]",new _,{description:"Reverse"}),e.addFunction("sort(list: T[], predicate: any):T[]",new j,{description:"Sort"}),e.addFunctionAlias("order","sort"),e.addFunction("remove(list: T[], predicate: boolean):T[]",new A,{description:"Remove"}),e.addFunctionAlias("delete","remove"),e.addFunction("push(list: T[], value: T):T[]",(e,t)=>(e.push(t),e),{description:"Push"}),e.addFunctionAlias("insert","push"),e.addFunction("bulkInsert(list: T[], value: T[]):T[]",(e,t)=>{for(let r of t)e.push(r);return e},{description:"Bulk Insert"}),e.addFunction("pop(list: T[]): T",e=>e.pop(),{description:"Pop"}),e.addFunction("length(source: any[]|string):number",e=>e.length,{description:"Length"}),e.addFunctionAlias("len","length"),e.addFunction("slice(list: T[], from:integer, to:integer):T[]",(e,t,r)=>e.slice(t,r),{description:"Slice"}),e.addFunction("page(list: T[], page:integer, records:integer):T[]",(e,t,r)=>{let n=(t-1)*r;n<0&&(n=0);let i=n+r;return i>e.length&&(i=e.length-1),e.slice(n,i)},{description:"Paging"})}groupFunctions(e){e.addFunction("distinct(list: any[], predicate: any): any[]",new T(this.helper),{description:"Distinct"}),e.addFunction("first(list: T[], predicate: boolean): T",new F(this.helper),{description:"First"}),e.addFunction("last(list: T[], predicate: boolean): T",new P(this.helper),{description:"Last"}),e.addFunction("count(list: T[], predicate: boolean): integer",new C(this.helper),{description:"Count"}),e.addFunction("max(list: T[], predicate: boolean): T",new $(this.helper),{description:"Max"}),e.addFunction("min(list: T[], predicate: boolean): T",new S(this.helper),{description:"Min"}),e.addFunction("avg(list: T[], value: number): number",new k(this.helper),{description:"Average"}),e.addFunction("sum(list: T[], value: number): number",new M(this.helper),{description:"Sum"})}setsFunctions(e){e.addFunction("union(a: T[], b: T[]): T[]",new D(this.helper),{description:"Union"}),e.addFunction("intersection(a: T[], b: T[]): T[]",new B(this.helper),{description:"Intersection"}),e.addFunction("difference(a: T[], b: T[]): T[]",new I(this.helper),{description:"Difference"}),e.addFunction("symmetricDifference(a: T[], b: T[]): T[]",new N(this.helper),{description:"Symmetric Difference"})}}t.CoreLibrary=s;class o extends i.PrototypeEvaluator{clone(e){return new o(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");return!!this.operand.children[0].eval(e)&&this.operand.children[1].eval(e)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");return!!await this.operand.children[0].solve(e)&&await this.operand.children[1].solve(e)}}class a extends i.PrototypeEvaluator{clone(e){return new a(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");return!!this.operand.children[0].eval(e)||this.operand.children[1].eval(e)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");return!!await this.operand.children[0].solve(e)||await this.operand.children[1].solve(e)}}class l extends i.PrototypeEvaluator{clone(e){return new l(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[1].eval(e);return e.data.set(this.operand.children[0].name,t),t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[1].solve(e);return e.data.set(this.operand.children[0].name,t),t}}class d extends i.PrototypeEvaluator{clone(e){return new d(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e)+this.operand.children[1].eval(e);return e.data.set(this.operand.children[0].name,t),t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e)+await this.operand.children[1].solve(e);return e.data.set(this.operand.children[0].name,t),t}}class u extends i.PrototypeEvaluator{clone(e){return new u(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e)-this.operand.children[1].eval(e);return e.data.set(this.operand.children[0].name,t),t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e)-await this.operand.children[1].solve(e);return e.data.set(this.operand.children[0].name,t),t}}class p extends i.PrototypeEvaluator{clone(e){return new p(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e)*this.operand.children[1].eval(e);return e.data.set(this.operand.children[0].name,t),t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e)*await this.operand.children[1].solve(e);return e.data.set(this.operand.children[0].name,t),t}}class h extends i.PrototypeEvaluator{clone(e){return new h(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e)/this.operand.children[1].eval(e);return e.data.set(this.operand.children[0].name,t),t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e)/await this.operand.children[1].solve(e);return e.data.set(this.operand.children[0].name,t),t}}class c extends i.PrototypeEvaluator{clone(e){return new c(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e)**this.operand.children[1].eval(e);return e.data.set(this.operand.children[0].name,t),t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e)**await this.operand.children[1].solve(e);return e.data.set(this.operand.children[0].name,t),t}}class f extends i.PrototypeEvaluator{clone(e){return new f(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=Math.floor(this.operand.children[0].eval(e)/this.operand.children[1].eval(e));return e.data.set(this.operand.children[0].name,t),t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=Math.floor(await this.operand.children[0].solve(e)/await this.operand.children[1].solve(e));return e.data.set(this.operand.children[0].name,t),t}}class v extends i.PrototypeEvaluator{clone(e){return new v(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e)%this.operand.children[1].eval(e);return e.data.set(this.operand.children[0].name,t),t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e)%await this.operand.children[1].solve(e);return e.data.set(this.operand.children[0].name,t),t}}class y extends i.PrototypeEvaluator{clone(e){return new y(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e)&this.operand.children[1].eval(e);return e.data.set(this.operand.children[0].name,t),t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e)&await this.operand.children[1].solve(e);return e.data.set(this.operand.children[0].name,t),t}}class m extends i.PrototypeEvaluator{clone(e){return new m(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e)|this.operand.children[1].eval(e);return e.data.set(this.operand.children[0].name,t),t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e)|await this.operand.children[1].solve(e);return e.data.set(this.operand.children[0].name,t),t}}class g extends i.PrototypeEvaluator{clone(e){return new g(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e)^this.operand.children[1].eval(e);return e.data.set(this.operand.children[0].name,t),t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e)^await this.operand.children[1].solve(e);return e.data.set(this.operand.children[0].name,t),t}}class b extends i.PrototypeEvaluator{clone(e){return new b(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e)<<this.operand.children[1].eval(e);return e.data.set(this.operand.children[0].name,t),t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e)<<await this.operand.children[1].solve(e);return e.data.set(this.operand.children[0].name,t),t}}class w extends i.PrototypeEvaluator{clone(e){return new w(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e)>>this.operand.children[1].eval(e);return e.data.set(this.operand.children[0].name,t),t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e)>>await this.operand.children[1].solve(e);return e.data.set(this.operand.children[0].name,t),t}}class O extends i.PrototypeEvaluator{constructor(e,t,r,n){super(n),this.builder=e,this.cloner=t,this.helper=r}clone(e){return new O(this.builder,this.cloner,this.helper,e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=[],r=this.operand.children[0].eval(e);if(!r)throw Error(`Array ${this.operand.children[0].name} undefined`);if(this.operand.children[2].type===n.OperandType.Obj){let n=[],i=[];for(let e of this.operand.children[2].children)e&&(this.helper.operand.haveAggregates(e.children[0])?i.push(e):n.push(e));if(i.length>0){let s=this.helper.operand.getKeys(this.operand.children[1],n,r,e),o=this.operand.children[1];for(let t of s)for(let r of i){let n=this.cloner.clone(r.children[0],"expression"),i=this.helper.operand.solveAggregates(t.items,o,n,e).eval(e);t.summarizers.push({name:r.name,value:i})}for(let e of s){let r={};for(let t of e.values)r[t.name]=t.value;for(let t of e.summarizers)r[t.name]=t.value;t.push(r)}return t}}else if(this.operand.children[2].type===n.OperandType.Var&&!Array.isArray(r))return r;let i=e.newContext();for(let e of r){i.data.set(this.operand.children[1].name,e);let r=this.operand.children[2].eval(i);t.push(r)}return t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=[],r=await this.operand.children[0].solve(e);if(!r)throw Error(`Array ${this.operand.children[0].name} undefined`);if(this.operand.children[2].type===n.OperandType.Obj){let n=[],i=[];for(let e of this.operand.children[2].children)e&&(this.helper.operand.haveAggregates(e.children[0])?i.push(e):n.push(e));if(i.length>0){let s=this.helper.operand.getKeys(this.operand.children[1],n,r,e),o=this.operand.children[1];for(let t of s)for(let r of i){let n=this.cloner.clone(r.children[0],"expression"),i=this.helper.operand.solveAggregates(t.items,o,n,e),s=await i.solve(e);t.summarizers.push({name:r.name,value:s})}for(let e of s){let r={};for(let t of e.values)r[t.name]=t.value;for(let t of e.summarizers)r[t.name]=t.value;t.push(r)}return t}}else if(this.operand.children[2].type===n.OperandType.Var&&!Array.isArray(r))return r;let i=e.newContext();for(let e of r){i.data.set(this.operand.children[1].name,e);let r=await this.operand.children[2].solve(i);t.push(r)}return t}}class T extends i.PrototypeEvaluator{constructor(e,t){super(t),this.helper=e}clone(e){return new T(this.helper,e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=[],r=this.operand.children[0].eval(e);if(!r)throw Error(`Array ${this.operand.children[0].name} undefined`);if(1===this.operand.children.length){for(let e of r)void 0===t.find(t=>t===e)&&t.push(e);return t}if(this.operand.children[2].type===n.OperandType.Obj){for(let n of this.helper.operand.getKeys(this.operand.children[1],this.operand.children[2].children,r,e.newContext())){let e={};for(let t of n.values)e[t.name]=t.value;t.push(e)}return t}if(this.operand.children[2].type===n.OperandType.List)throw Error("Distinct not support Array result");let i=e.newContext();for(let e of r){i.data.set(this.operand.children[1].name,e);let r=this.operand.children[2].eval(i);void 0===t.find(e=>e===r)&&t.push(r)}return t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=[],r=await this.operand.children[0].solve(e);if(!r)throw Error(`Array ${this.operand.children[0].name} undefined`);if(1===this.operand.children.length){for(let e of r)void 0===t.find(t=>t===e)&&t.push(e);return t}if(this.operand.children[2].type===n.OperandType.Obj){for(let n of this.helper.operand.getKeys(this.operand.children[1],this.operand.children[2].children,r,e.newContext())){let e={};for(let t of n.values)e[t.name]=t.value;t.push(e)}return t}if(this.operand.children[2].type===n.OperandType.List)throw Error("Distinct not support Array result");let i=e.newContext();for(let e of r){i.data.set(this.operand.children[1].name,e);let r=await this.operand.children[2].solve(i);void 0===t.find(e=>e===r)&&t.push(r)}return t}}class x extends i.PrototypeEvaluator{clone(e){return new x(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e);if(!t)throw Error(`Array ${this.operand.children[0].name} undefined`);let r=e.newContext();for(let e of t)r.data.set(this.operand.children[1].name,e),this.operand.children[2].eval(r);return t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e);if(!t)throw Error(`Array ${this.operand.children[0].name} undefined`);let r=e.newContext();for(let e of t)r.data.set(this.operand.children[1].name,e),await this.operand.children[2].solve(r);return t}}class E extends i.PrototypeEvaluator{clone(e){return new E(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=[],r=this.operand.children[0].eval(e);if(!r)throw Error(`Array ${this.operand.children[0].name} undefined`);let n=e.newContext();for(let e of r)n.data.set(this.operand.children[1].name,e),this.operand.children[2].eval(n)&&t.push(e);return t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=[],r=await this.operand.children[0].solve(e);if(!r)throw Error(`Array ${this.operand.children[0].name} undefined`);let n=e.newContext();for(let e of r)n.data.set(this.operand.children[1].name,e),await this.operand.children[2].solve(n)&&t.push(e);return t}}class _ extends i.PrototypeEvaluator{clone(e){return new _(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e);if(!t)throw Error(`Array ${this.operand.children[0].name} undefined`);if(1===this.operand.children.length)return t.reverse();let r=[],n=e.newContext();for(let e of t){n.data.set(this.operand.children[1].name,e);let t=this.operand.children[2].eval(n);r.push({value:t,p:e})}return r.sort((e,t)=>e.value>t.value?1:e.value<t.value?-1:0),r.reverse(),r.map(e=>e.p)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e);if(!t)throw Error(`Array ${this.operand.children[0].name} undefined`);if(1===this.operand.children.length)return t.reverse();let r=[],n=e.newContext();for(let e of t){n.data.set(this.operand.children[1].name,e);let t=await this.operand.children[2].solve(n);r.push({value:t,p:e})}return r.sort((e,t)=>e.value>t.value?1:e.value<t.value?-1:0),r.reverse(),r.map(e=>e.p)}}class j extends i.PrototypeEvaluator{clone(e){return new j(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=[],r=this.operand.children[0].eval(e);if(!r)throw Error(`Array ${this.operand.children[0].name} undefined`);if(1===this.operand.children.length)return r.sort();let n=e.newContext();for(let e of r){n.data.set(this.operand.children[1].name,e);let r=this.operand.children[2].eval(n);t.push({value:r,p:e})}return t.sort((e,t)=>e.value>t.value?1:e.value<t.value?-1:0),t.map(e=>e.p)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=[],r=await this.operand.children[0].solve(e);if(!r)throw Error(`Array ${this.operand.children[0].name} undefined`);if(1===this.operand.children.length)return r.sort();let n=e.newContext();for(let e of r){n.data.set(this.operand.children[1].name,e);let r=await this.operand.children[2].solve(n);t.push({value:r,p:e})}return t.sort((e,t)=>e.value>t.value?1:e.value<t.value?-1:0),t.map(e=>e.p)}}class A extends i.PrototypeEvaluator{clone(e){return new A(e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=[],r=this.operand.children[0].eval(e);if(!r)throw Error(`Array ${this.operand.children[0].name} undefined`);let n=e.newContext();for(let e of r)n.data.set(this.operand.children[1].name,e),this.operand.children[2].eval(n)||t.push(e);return t}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=[],r=await this.operand.children[0].solve(e);if(!r)throw Error(`Array ${this.operand.children[0].name} undefined`);let n=e.newContext();for(let e of r)n.data.set(this.operand.children[1].name,e),await this.operand.children[2].solve(n)||t.push(e);return t}}class F extends i.PrototypeEvaluator{constructor(e,t){super(t),this.helper=e}clone(e){return new F(this.helper,e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");return this.first(this.operand.children[0].eval(e),e)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");return this.first(await this.operand.children[0].solve(e),e)}first(e,t){if(void 0===this.operand)throw Error("Operand undefined");if(!e)throw Error(`Array ${this.operand.children[0].name} undefined`);return 1===this.operand.children.length?e&&e.length>0?e[0]:null:this.helper.operand.first(e,this.operand.children[1],this.operand.children[2],t.newContext())}}class P extends i.PrototypeEvaluator{constructor(e,t){super(t),this.helper=e}clone(e){return new P(this.helper,e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");return this.last(this.operand.children[0].eval(e),e)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");return this.last(await this.operand.children[0].solve(e),e)}last(e,t){if(void 0===this.operand)throw Error("Operand undefined");if(!e)throw Error(`Array ${this.operand.children[0].name} undefined`);return 1===this.operand.children.length?e&&e.length>0?e[e.length-1]:null:this.helper.operand.last(e,this.operand.children[1],this.operand.children[2],t.newContext())}}class C extends i.PrototypeEvaluator{constructor(e,t){super(t),this.helper=e}clone(e){return new C(this.helper,e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");return this.count(this.operand.children[0].eval(e),e)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");return this.count(await this.operand.children[0].solve(e),e)}count(e,t){if(void 0===this.operand)throw Error("Operand undefined");if(!e)throw Error(`Array ${this.operand.children[0].name} undefined`);return 1===this.operand.children.length?e.length:this.helper.operand.count(e,this.operand.children[1],this.operand.children[2],t.newContext())}}class $ extends i.PrototypeEvaluator{constructor(e,t){super(t),this.helper=e}clone(e){return new $(this.helper,e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");return this.max(this.operand.children[0].eval(e),e)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");return this.max(await this.operand.children[0].solve(e),e)}max(e,t){if(void 0===this.operand)throw Error("Operand undefined");if(!e)throw Error(`Array ${this.operand.children[0].name} undefined`);if(1===this.operand.children.length){let t;for(let r of e)(void 0===t||null!==r&&r>t)&&(t=r);return t}return this.helper.operand.max(e,this.operand.children[1],this.operand.children[2],t.newContext())}}class S extends i.PrototypeEvaluator{constructor(e,t){super(t),this.helper=e}clone(e){return new S(this.helper,e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");return this.min(this.operand.children[0].eval(e),e)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");return this.min(await this.operand.children[0].solve(e),e)}min(e,t){if(void 0===this.operand)throw Error("Operand undefined");if(!e)throw Error(`Array ${this.operand.children[0].name} undefined`);if(1===this.operand.children.length){let t;for(let r of e)(void 0===t||null!==r&&r<t)&&(t=r);return t}return this.helper.operand.min(e,this.operand.children[1],this.operand.children[2],t.newContext())}}class k extends i.PrototypeEvaluator{constructor(e,t){super(t),this.helper=e}clone(e){return new k(this.helper,e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");return this.avg(this.operand.children[0].eval(e),e)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");return this.avg(await this.operand.children[0].solve(e),e)}avg(e,t){if(void 0===this.operand)throw Error("Operand undefined");if(1===this.operand.children.length){let t=0;for(let r of e)null!==r&&(t+=r);return e.length>0?t/e.length:0}return this.helper.operand.avg(e,this.operand.children[1],this.operand.children[2],t.newContext())}}class M extends i.PrototypeEvaluator{constructor(e,t){super(t),this.helper=e}clone(e){return new M(this.helper,e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");return this.sum(this.operand.children[0].eval(e),e)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");return this.sum(await this.operand.children[0].solve(e),e)}sum(e,t){if(void 0===this.operand)throw Error("Operand undefined");if(!e)throw Error(`Array ${this.operand.children[0].name} undefined`);if(1===this.operand.children.length){let t=0;for(let r of e)null!==r&&(t+=r);return t}return this.helper.operand.sum(e,this.operand.children[1],this.operand.children[2],t.newContext())}}class D extends i.PrototypeEvaluator{constructor(e,t){super(t),this.helper=e}clone(e){return new D(this.helper,e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e),r=this.operand.children[1].eval(e);return this.union(t,r)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e),r=await this.operand.children[1].solve(e);return this.union(t,r)}union(e,t){if(0===e.length)return t;if(0===t.length)return e;let r=[];if(Array.isArray(e[0])||Array.isArray(t[0]))throw Error("Cannot union arrays of arrays");if("object"==typeof e[0]){for(let t of e){let e=this.helper.operand.objectKey(t);r.push({key:e,value:t})}for(let e of t){let t=this.helper.operand.objectKey(e);r.find(e=>e.key===t)||r.push({key:t,value:e})}return r.map(e=>e.value)}for(let n of(r=r.concat(e),t))r.includes(n)||r.push(n);return r}}class B extends i.PrototypeEvaluator{constructor(e,t){super(t),this.helper=e}clone(e){return new B(this.helper,e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e),r=this.operand.children[1].eval(e);return this.intersection(t,r)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e),r=await this.operand.children[1].solve(e);return this.intersection(t,r)}intersection(e,t){if(void 0===this.operand)throw Error("Operand undefined");if(!e)throw Error(`Array ${this.operand.children[0].name} undefined`);if(!t)throw Error(`Array ${this.operand.children[1].name} undefined`);if(0===e.length||0===t.length)return[];let r=[];if(Array.isArray(e[0])||Array.isArray(t[0]))throw Error("Cannot union arrays of arrays");if("object"==typeof e[0]){let n=e.map(e=>this.helper.operand.objectKey(e));for(let e of t){let t=this.helper.operand.objectKey(e);n.includes(t)&&r.push(e)}return r}for(let n of t)e.includes(n)&&r.push(n);return r}}class I extends i.PrototypeEvaluator{constructor(e,t){super(t),this.helper=e}clone(e){return new I(this.helper,e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e),r=this.operand.children[1].eval(e);return this.difference(t,r)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e),r=await this.operand.children[1].solve(e);return this.difference(t,r)}difference(e,t){if(void 0===this.operand)throw Error("Operand undefined");if(!e)throw Error(`Array ${this.operand.children[0].name} undefined`);if(!t)throw Error(`Array ${this.operand.children[1].name} undefined`);if(0===e.length)return[];if(0===t.length)return e;let r=[];if(Array.isArray(e[0])||Array.isArray(t[0]))throw Error("Cannot union arrays of arrays");if("object"==typeof e[0]){let n=t.map(e=>this.helper.operand.objectKey(e));for(let t of e){let e=this.helper.operand.objectKey(t);n.includes(e)||r.push(t)}return r}for(let n of e)t.includes(n)||r.push(n);return r}}class N extends i.PrototypeEvaluator{constructor(e,t){super(t),this.helper=e}clone(e){return new N(this.helper,e)}eval(e){if(void 0===this.operand)throw Error("Operand undefined");let t=this.operand.children[0].eval(e),r=this.operand.children[1].eval(e);return this.symmetricDifference(t,r)}async evalAsync(e){if(void 0===this.operand)throw Error("Operand undefined");let t=await this.operand.children[0].solve(e),r=await this.operand.children[1].solve(e);return this.symmetricDifference(t,r)}symmetricDifference(e,t){if(void 0===this.operand)throw Error("Operand undefined");if(!e)throw Error(`Array ${this.operand.children[0].name} undefined`);if(!t)throw Error(`Array ${this.operand.children[1].name} undefined`);if(0===e.length)return t;if(0===t.length)return e;let r=[];if(Array.isArray(e[0])||Array.isArray(t[0]))throw Error("Cannot union arrays of arrays");if("object"==typeof e[0]){let n=e.map(e=>this.helper.operand.objectKey(e)),i=t.map(e=>this.helper.operand.objectKey(e));for(let t of e){let e=this.helper.operand.objectKey(t);i.includes(e)||r.push(t)}for(let e of t){let t=this.helper.operand.objectKey(e);n.includes(t)||r.push(e)}return r}for(let n of e)t.includes(n)||r.push(n);for(let n of t)e.includes(n)||r.push(n);return r}}},9313:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.unsubscribe=t.subscribe=t.evalAsync=t.evaluate=t.parameters=t.expressions=t.exprHelper=void 0;let s=r(741),o=r(8293),a=r(8490);i(r(8169),t),i(r(741),t),i(r(8774),t),i(r(6899),t),i(r(5051),t),i(r(7887),t),i(r(300),t),i(r(7989),t),i(r(8442),t),i(r(7943),t),t.exprHelper=new s.ExprH3lp(a.typeH3lp),t.expressions=new o.ExpressionsBuilder(t.exprHelper).build(),t.parameters=e=>t.expressions.parameters(e),t.evaluate=(e,r)=>t.expressions.eval(e,r),t.evalAsync=(e,r)=>t.expressions.evalAsync(e,r),t.subscribe=e=>{t.expressions.subscribe(e)},t.unsubscribe=e=>{t.expressions.subscribe(e)}},6899:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(9944),t)},9944:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ModelServiceImpl=void 0;let n=r(5051);class i{constructor(){this._enums={},this._constants={},this._formats={},this._operators={},this._functions={},this._operatorAlias={},this._functionAlias={}}get operatorAlias(){return Object.entries(this._operatorAlias)}get functionAlias(){return Object.entries(this._functionAlias)}get constants(){return Object.entries(this._constants)}get formats(){return Object.entries(this._formats)}get enums(){return Object.entries(this._enums)}get operators(){let e=[];for(let t of Object.entries(this._operators))for(let r of Object.values(t[1]))e.push([t[0],r]);for(let t of Object.entries(this._operatorAlias)){let r=t[1];for(let n of Object.values(this._operators[r]))e.push([t[0],n])}return e}get functions(){let e=[];for(let t of(e=Object.entries(this._functions),Object.entries(this._functionAlias))){let r=t[1];e.push([t[0],this._functions[r]])}return e}addEnum(e,t){if(Array.isArray(t))t.length>0&&(this._enums[e]=t);else if("object"==typeof t){let r=[];for(let e of Object.entries(t))r.push([e[0],e[1]]);this._enums[e]=r}else throw Error(`enum ${e} invalid values`)}addFormat(e,t){this._formats[e]={name:e,pattern:t,regExp:new RegExp(t)}}addConstant(e,t){this._constants[e]=t}addOperatorAlias(e,t){this._operatorAlias[e]=t}addFunctionAlias(e,t){this._functionAlias[e]=t}addLibrary(e){e.load(this)}addOperator(e,t,r){let i=this.getSing(e),s={priority:r.priority,deterministic:!1,operands:i.params.length,doc:r.doc?r.doc:{description:r.description||e},params:i.params,returnType:i.returnType,async:r.async||!1};if(t instanceof n.PrototypeEvaluator)s.custom=t;else if("function"==typeof t)s.function=t;else throw Error(`operator ${i.name} source not supported`);r&&r.doc&&(s.doc=r.doc),void 0===this._operators[i.name]&&(this._operators[i.name]={}),this._operators[i.name][s.operands]=s}addFunction(e,t,r){let i=this.getSing(e),s={deterministic:!r||!r.deterministic||r.deterministic,operands:i.params.length,params:i.params,returnType:i.returnType,doc:r.doc?r.doc:{description:r.description||e},async:!!r&&!!r.async&&r.async};if(t instanceof n.PrototypeEvaluator)s.custom=t;else if("function"==typeof t)s.function=t;else throw Error(`function ${i.name} source not supported`);r&&r.doc&&(s.doc=r.doc),this._functions[i.name]=s}getEnumValue(e,t){if(void 0===this._enums[e])throw Error(`enum: ${e} not found `);let r=this._enums[e].find(e=>e[0]===t);if(void 0===r)throw Error(`option ${t} in enum: ${e} not found `);return r[1]}getEnum(e){return this._enums[e]}getConstantValue(e){return this._constants[e]}getFormat(e){return this._formats[e]}getOperator(e,t){let r=this._operators[e];if(void 0===r){let t=this._operatorAlias[e];if(t)r=this._operators[t];else throw Error(`operator: ${e} not found `)}if(void 0!==t){let n=r[t];if(void 0===n)throw Error(`operator ${e} with ${t} operands not found `);return n}if(1===Object.keys(r).length)return Object.values(r)[0];if(void 0!==r[2])return r[2];throw Error(`it is necessary to determine the number of operands for the operator ${e}`)}getFunction(e){let t=this._functions[e];if(void 0===t){let r=this._functionAlias[e];if(r)t=this._functions[r];else throw Error(`function: ${e} not found `)}return t}isEnum(e){let t=e.split(".");return void 0!==this._enums[t[0]]}isConstant(e){return void 0!==this._constants[e]}isOperator(e,t){let r=this._operators[e];if(void 0===r){let t=this._operatorAlias[e];if(!t)return!1;r=this._operators[t]}return void 0===t||r&&void 0!==r[t]}isFunction(e){return void 0!==this._functions[e]||void 0!==this._functionAlias[e]}priority(e,t){let r=this.getOperator(e,t);return r&&r.priority?r.priority:-1}getSing(e){let t=Array.from(e),r=t.length,n=0,i="",s="",o="",a=[];for(;" "===t[n];)n++;for(;"("!==t[n];n++)" "===t[n]&&" "!==t[n+1]&&"("!==t[n+1]?(s=a.join(""),a=[]):" "!==t[n]&&a.push(t[n]);i=a.join(""),a=[];let l=[],d="",u="",p="",h=!1,c=!1;for(n++;n<r;n++)if(","===t[n]||")"===t[n]){if(h?(p=a.join(""),""===u&&(u=this.getTypeFromValue(p))):u=a.join(""),d.startsWith("...")&&(c=!0,d=d.replace("...","")),l.push({name:d,type:""!==u?u:"any",default:""!==p?p:void 0,multiple:c}),")"===t[n])break;a=[],d="",u="",p="",h=!1,c=!1}else":"===t[n]?(d=a.join(""),a=[]):"="===t[n]?(h=!0,""===d?d=a.join(""):u=a.join(""),a=[]):" "!==t[n]&&a.push(t[n]);a=[];let f=!1;for(n++;n<r;n++){if(":"===t[n]){f=!0;continue}" "!==t[n]&&a.push(t[n])}return f&&(o=a.join("")),{name:i,returnType:""!==o?o:"void",params:l,isAsync:"async"===s}}getTypeFromValue(e){return e}}t.ModelServiceImpl=i},8774:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(7195),t),i(r(9770),t)},9770:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7195:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3881:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperandFacadeImpl=void 0;let n=r(8490);class i{constructor(e,t,r,n){this.constBuilder=e,this.parameterService=t,this.operandBuild=r,this.operandClone=n}getBuilder(e){return this.operandBuild.get(e)}parameters(e){let t=this.operandBuild.build(e,"expression");return this.parameterService.parameters(t)}type(e){let t=this.operandBuild.build(e,"expression");return n.Type.stringify(t.returnType)}build(e,t="expression"){return this.operandBuild.build(e,t)}clone(e,t="expression"){return this.operandClone.clone(e,t)}}t.OperandFacadeImpl=i},7887:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(5435),t),i(r(7094),t),i(r(9063),t),i(r(9636),t),i(r(7652),t),i(r(332),t),i(r(6376),t),i(r(2957),t),i(r(322),t),i(r(6441),t),i(r(2716),t),i(r(1728),t),i(r(334),t),i(r(3881),t)},2716:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperandBuilderImpl=void 0;let n=r(6441),i=r(334),s=r(7887);class o{constructor(e,t,r){this.evaluatorFactory=e,this.model=t,this.constBuilder=r,this.parse=new n.ExpressionParse(this.model),this.normalize=new i.ExpressionNormalizer,this.operandNormalize=new s.OperandNormalize(this.model),this.operandComplete=new s.OperandComplete(this.evaluatorFactory),this.operandReduce=new s.OperandReduce(this.model,this.constBuilder),this.typeService=new s.TypeServiceImpl(this.model)}build(e){let t=this.normalize.normalize(e),r=this.parse.parse(t),n=this.operandNormalize.normalize(r),i=this.operandComplete.complete(n),s=this.operandReduce.reduce(i);return s.returnType=this.typeService.getType(s),s}}t.OperandBuilderImpl=o},1728:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperandBuilderCacheDecorator=void 0;let n=r(7887);class i{constructor(e,t,r,i){this.builder=e,this.cache=t,this.serializer=r,this.utils=i,this.operandComplete=new n.OperandComplete(e.evaluatorFactory)}get evaluatorFactory(){return this.builder.evaluatorFactory}build(e){let t=this.utils.hashCode(e).toString(),r=this.cache.get(t);if(r){let e=this.serializer.deserialize(r);return this.operandComplete.complete(e)}let n=this.builder.build(e);return this.cache.set(t,this.serializer.serialize(n)),n}}t.OperandBuilderCacheDecorator=i},5435:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EvaluatorFactoryImpl=void 0;class r{constructor(){this.evaluators={}}add(e,t){return this.evaluators[e]=t,this}get(e){return this.evaluators[e]}create(e){let t=this.get(e.type);if(void 0===t)throw Error(`Evaluator for ${e.type} ${e.name} not found`);return t.build(e)}}t.EvaluatorFactoryImpl=r},334:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionNormalizer=void 0;let n=r(9827);class i{normalize(e){let t=!1,r="",i=e.split(""),s=i.length,o=[],a=0,l=0,d=0;for(;d<s;){let e=i[d];t&&e===r?t=!1:t||"'"!==e&&'"'!==e&&"`"!==e||(t=!0,r=e),t?o.push([e,a,l]):" "===e?d+1<s&&d-1>=0&&n.h3lp.val.isAlphanumeric(i[d-1])&&n.h3lp.val.isAlphanumeric(i[d+1])&&o.push([e,a,l]):"\n"===e?(a++,l=0):"\r"!==e&&"        "!==e&&o.push([e,a,l]),d++,l++}return";"===o[o.length-1][0]&&o.splice(-1),o}}t.ExpressionNormalizer=i},322:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParameterServiceImpl=void 0;let n=r(8169),i=r(8490);class s{parameters(e){let t=[];for(let r of(e.type===n.OperandType.Var&&t.push({name:e.name,type:i.Type.stringify(e.returnType)}),e.children)){let e=this.parameters(r).filter(e=>!t.map(e=>e.name).includes(e.name));e.length>0&&t.push(...e)}return t}}t.ParameterServiceImpl=s},6441:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionParse=t.Parser=void 0;let n=r(9827),i=r(8169),s=r(8490);class o{constructor(e,t){for(let r of(this.model=e,this.expression=t,this.buffer=this.expression.map(e=>e[0]),this.length=this.buffer.length,this.index=0,this.singleOperators=[],this.doubleOperators=[],this.tripleOperators=[],this.assignmentOperators=[],this.model.operators)){let e=r[0],t=r[1];1===e.length?this.singleOperators.push(e):2===e.length?(this.doubleOperators.push(e),1===t.priority&&this.assignmentOperators.push(e)):3===e.length&&this.tripleOperators.push(e)}}parse(){let e=[];for(;!this.end;){let t=this.getExpression(void 0,void 0,";");if(!t)break;e.push(t)}return 1===e.length?e[0]:new i.Operand(new i.Position(0,0),"block",i.OperandType.Block,e)}getExpression(e,t,r=""){let n,s;let o=!1,a=this.pos();for(;!this.end;){if(!e&&!t&&(e=this.getOperand(),!(t=this.getOperator())||r.includes(this.current))){r.includes(this.current)&&(this.index+=1),n=e,o=!0;break}s=this.getOperand();let a=this.getOperator();if(t&&e){if(!a||r.includes(this.current)){r.includes(this.current)&&(this.index+=1),n=new i.Operand(this.pos(t.length),t,i.OperandType.Operator,[e,s]),o=!0;break}if(this.model.priority(t)>=this.model.priority(a))e=new i.Operand(this.pos(t.length),t,i.OperandType.Operator,[e,s]),t=a;else{s=this.getExpression(s,a,r),n=new i.Operand(this.pos(t.length),t,i.OperandType.Operator,[e,s]),o=!0;break}}}return!o&&e&&s&&(n=new i.Operand(a,t,i.OperandType.Operator,[e,s])),n}getOperand(){let e=!1,t=!1,r=!1,o=null,a=this.current;"-"===a?(e=!0,this.index+=1,a=this.current):"~"===a?(r=!0,this.index+=1,a=this.current):"!"===a&&(t=!0,this.index+=1,a=this.current);let l=this.pos();if(n.h3lp.val.isAlphanumeric(a)){let t=this.getValue();if("function"===t&&"("===this.current)this.index+=1,o=this.getFunctionBlock(l);else if("if"===t&&"("===this.current)this.index+=1,o=this.getIfBlock(l);else if("for"===t&&"("===this.current)this.index+=1,o=this.getForBlock(l);else if("while"===t&&"("===this.current)this.index+=1,o=this.getWhileBlock(l);else if("switch"===t&&"("===this.current)this.index+=1,o=this.getSwitchBlock(l);else if(this.end||"("!==this.current){if("try"===t&&"{"===this.current)o=this.getTryCatchBlock(l);else if("throw"===t)o=this.getThrow(l);else if("return"===t)o=this.getReturn(l);else if("break"===t)o=new i.Operand(l,"break",i.OperandType.Break);else if("continue"===t)o=new i.Operand(l,"continue",i.OperandType.Continue);else if(this.end||"["!==this.current){if(n.h3lp.val.isIntegerFormat(t))e?(t=-1*parseInt(t),e=!1):r?(t=~parseInt(t),r=!1):t=parseInt(t),o=new i.Operand(l,t,i.OperandType.Const,[],s.Type.integer);else if(n.h3lp.val.isDecimalFormat(t))e?(t=-1*parseFloat(t),e=!1):r?(t=~parseFloat(t),r=!1):t=parseFloat(t),o=new i.Operand(l,t,i.OperandType.Const,[],s.Type.decimal);else if(this.model.isConstant(t)){let e=this.model.getConstantValue(t);o=new i.Operand(l,e,i.OperandType.Const,[],s.Type.get(e))}else o=this.model.isEnum(t)?this.getEnum(t,l):new i.Operand(l,t,i.OperandType.Var)}else this.index+=1,o=this.getIndexOperand(t,l)}else if(this.index+=1,t.includes(".")&&!this.model.isFunction(t)){let e=n.h3lp.obj.names(t),r=e.pop(),s=e.join("."),a=new i.Operand(l,s,i.OperandType.Var);o=this.getChildFunc(r,a)}else if(")"===this.current)this.index++,o=new i.Operand(l,t,i.OperandType.CallFunc,[]);else{let e=this.getArgs(")");o=new i.Operand(l,t,i.OperandType.CallFunc,e)}}else if("'"===a||'"'===a){this.index+=1;let e=this.getString(a);o=new i.Operand(l,e,i.OperandType.Const,[],s.Type.string)}else if("`"===a){this.index+=1;let e=this.getTemplate();o=new i.Operand(l,e,i.OperandType.Template,[],s.Type.string)}else if("("===a)this.index+=1,o=this.getExpression(void 0,void 0,")");else if("{"===a)this.index+=1,o=this.getObject(l);else if("["===a){this.index+=1;let e=this.getArgs("]");o=new i.Operand(l,"array",i.OperandType.List,e)}else if("$"===a){let e;if("{"===this.offset(1)){if(this.index+=2,e=this.getValue(),!this.end&&this.nextIs("}"))this.index+=1;else throw Error(`Not found character "}" in Environment variable ${e}`)}else this.index+=1,e=this.getValue();o=new i.Operand(l,e,i.OperandType.Env)}if(null===o)throw Error("Operand undefined");return o=this.solveChain(o,l),e&&(o=new i.Operand(new i.Position(l.ln,l.col-1),"-",i.OperandType.Operator,[o])),t&&(o=new i.Operand(new i.Position(l.ln,l.col-1),"!",i.OperandType.Operator,[o])),r&&(o=new i.Operand(new i.Position(l.ln,l.col-1),"~",i.OperandType.Operator,[o])),o}solveChain(e,t){if(this.end)return e;if("."===this.current){this.index+=1;let r=this.getValue();if("("===this.current){if(this.index+=1,!r.includes(".")||this.model.isFunction(r))return this.solveChain(this.getChildFunc(r,e),t);{let s=n.h3lp.obj.names(r),o=s.slice(0,-1).join("."),a=s.slice(-1)[0],l=new i.Operand(t,o,i.OperandType.Property,[e]);return this.solveChain(this.getChildFunc(a,l),t)}}if("["!==this.current)return new i.Operand(t,r,i.OperandType.Property,[e]);if(this.index+=1,r.includes(".")){let n=new i.Operand(t,r,i.OperandType.Property,[e]),s=this.getExpression(void 0,void 0,"]");return new i.Operand(t,"[]",i.OperandType.Operator,[n,s])}{let n=new i.Operand(t,r,i.OperandType.Property,[e]),s=this.getExpression(void 0,void 0,"]");return new i.Operand(t,"[]",i.OperandType.Operator,[n,s])}}if("["!==this.current)return e;{this.index+=1;let r=this.getExpression(void 0,void 0,"]");return new i.Operand(t,"[]",i.OperandType.Operator,[e,r])}}getOperator(){if(this.end)return;let e=null;if(this.index+2<this.length){let t=this.current+this.offset(1)+this.offset(2);this.tripleOperators.includes(t)&&(e=t)}if(null===e&&this.index+1<this.length){let t=this.current+this.offset(1);this.doubleOperators.includes(t)&&(e=t)}if(null===e){if(!this.model.isOperator(this.current))return;e=this.current}return this.index+=e.length,e}normalize(e){let t=!1,r="",i=e.split(""),s=i.length,o=[],a=0,l=0,d=0;for(;d<s;){let e=i[d];t&&e===r?t=!1:t||"'"!==e&&'"'!==e&&"`"!==e||(t=!0,r=e),t?o.push([e,a,l]):" "===e?d+1<s&&d-1>=0&&n.h3lp.val.isAlphanumeric(i[d-1])&&n.h3lp.val.isAlphanumeric(i[d+1])&&o.push([e,a,l]):"\n"===e?(a++,l=0):"\r"!==e&&"  "!==e&&o.push([e,a,l]),d++,l++}return";"===o[o.length-1][0]&&o.splice(-1),o}get end(){return this.index>=this.length}get current(){return this.buffer[this.index]}offset(e=0){return this.buffer[this.index+e]}pos(e=0){let t=this.expression[this.index-e];return new i.Position(t[1],t[2])}nextIs(e){let t=e.split("");for(let e=0;e<t.length;e++)if(this.buffer[this.index+e]!==t[e])return!1;return!0}getValue(e=!0){let t=[];if(e)for(;!this.end&&n.h3lp.val.isAlphanumeric(this.current);)t.push(this.current),this.index+=1;else{let e=this.index;for(;!this.end&&n.h3lp.val.isAlphanumeric(this.buffer[e]);)t.push(this.buffer[e]),e+=1}return t.join("")}getString(e){let t=[];for(;!this.end&&(this.current!==e||this.index+1<this.length&&this.offset(1)===e||this.offset(-1)===e);)t.push(this.current),this.index+=1;return this.index+=1,t.join("")}getTemplate(){let e=[];for(;!this.end&&"`"!==this.current;)e.push(this.current),this.index+=1;return this.index+=1,e.join("")}getArgs(e=")"){let t=[];for(;;){let r=this.getExpression(void 0,void 0,","+e);if(null!=r&&t.push(r),this.offset(-1)===e)break}return t}getObject(e){let t=[];for(;;){let e=null;if('"'===this.current||"'"===this.current){let t=this.current;this.index+=1,e=this.getString(t)}else e=this.getValue();if(":"===this.current)this.index+=1;else throw Error("attribute "+e+" without value");let r=this.pos(),n=this.getExpression(void 0,void 0,",}"),s=new i.Operand(r,e,i.OperandType.KeyVal,[n]);if(t.push(s),"}"===this.offset(-1))break}return new i.Operand(e,"obj",i.OperandType.Obj,t)}getBlock(){let e=this.pos(),t=[];for(;;){let e=this.getExpression(void 0,void 0,";}");if(null!=e&&t.push(e),";"===this.offset(-1)&&"}"===this.current){this.index+=1;break}if("}"===this.offset(-1))break}return new i.Operand(e,"block",i.OperandType.Block,t)}getControlBlock(){return"{"===this.current?(this.index+=1,this.getBlock()):this.getExpression(void 0,void 0,";")}getReturn(e){let t=this.getExpression(void 0,void 0,";");return new i.Operand(e,"return",i.OperandType.Return,[t])}getTryCatchBlock(e){let t=[],r=this.getControlBlock();if(t.push(r),this.nextIs("catch")){let e=[],r=this.pos(5);if(this.index+=5,"("===this.current){this.index+=1;let t=this.getExpression(void 0,void 0,")");e.push(t)}let n=this.getControlBlock();e.push(n);let s=new i.Operand(r,"catch",i.OperandType.Catch,e);t.push(s)}return";"===this.current&&(this.index+=1),new i.Operand(e,"try",i.OperandType.Try,t)}getThrow(e){let t=this.getExpression(void 0,void 0,";");return new i.Operand(e,"throw",i.OperandType.Throw,[t])}getIfBlock(e){let t=[],r=this.getExpression(void 0,void 0,")");t.push(r);let n=this.getControlBlock();for(t.push(n);this.nextIs("elseif(");){let e=this.pos();this.index+=7;let r=this.getExpression(void 0,void 0,")"),n=this.getControlBlock(),s=new i.Operand(e,"elseif",i.OperandType.ElseIf,[r,n]);t.push(s)}if(this.nextIs("else")){this.index+=4;let e=this.getControlBlock();t.push(e)}return new i.Operand(e,"if",i.OperandType.If,t)}getSwitchBlock(e){let t=[],r=this.getExpression(void 0,void 0,")");t.push(r),"{"===this.current&&(this.index+=1);let n=this.nextIs("case")?"case":this.nextIs("default:")?"default:":"";for(;"case"===n;){let e;if(this.index+=4,"'"===this.current||'"'===this.current){let t=this.current;this.index+=1,e=this.getString(t)}else e=this.getValue();let r=new i.Operand(this.pos(),e,i.OperandType.Case),s=new i.Operand(this.pos(),"block",i.OperandType.Block);r.children=[s],":"===this.current&&(this.index+=1);let o=[];for(;;){let e=this.getExpression(void 0,void 0,";}");if(void 0!==e&&o.push(e),this.nextIs("case")){n="case";break}if(this.nextIs("default:")){n="default:";break}if("}"===this.current||"}"===this.offset(-1)){n="end";break}}s.children=o,t.push(r)}if("default:"===n){this.index+=8;let e=new i.Operand(this.pos(),"default",i.OperandType.Default),r=new i.Operand(this.pos(),"block",i.OperandType.Block);e.children=[r];let n=[];for(;;){let e=this.getExpression(void 0,void 0,";}");if(void 0!==e&&n.push(e),"}"===this.current||"}"===this.offset(-1))break}r.children=n,t.push(e)}return"}"===this.current&&(this.index+=1),new i.Operand(e,"switch",i.OperandType.Switch,t)}getWhileBlock(e){let t=this.getExpression(void 0,void 0,")"),r=this.getControlBlock();return new i.Operand(e,"while",i.OperandType.While,[t,r])}getForBlock(e){let t=this.getExpression(void 0,void 0,"; ");if(";"===this.offset(-1)){let r=this.getExpression(void 0,void 0,";"),n=this.getExpression(void 0,void 0,")"),s=this.getControlBlock();return new i.Operand(e,"for",i.OperandType.For,[t,r,n,s])}if(this.nextIs("in")){for(this.index+=2;" "===this.current;)this.index+=1;let r=this.getExpression(void 0,void 0,")"),n=this.getControlBlock();return new i.Operand(e,"forIn",i.OperandType.ForIn,[t,r,n])}throw Error("expression for error")}getFunctionBlock(e){let t=this.getValue();"("===this.current&&(this.index+=1);let r=this.pos(),n=this.getArgs(),s=this.getBlock(),o=new i.Operand(r,"args",i.OperandType.Args,n);return new i.Operand(e,t,i.OperandType.Func,[o,s])}getChildFunc(e,t){let r=!1,n=this.pos(),s=this.getValue(!1);if(""!==s){let e=s.length;("="===this.offset(e)||"-"===this.offset(e))&&">"===this.offset(e+1)&&(r=!0,this.index+=s.length+2)}else this.current+this.offset(1)==="()"?("="===this.offset(2)||"-"===this.offset(2))&&">"===this.offset(3)&&(r=!0,this.index+=4):(this.current+this.offset(1)==="=>"||this.current+this.offset(1)==="->")&&(r=!0,this.index+=2);if(r){let r=new i.Operand(n,s,i.OperandType.Var),o=this.getExpression(void 0,void 0,")");return new i.Operand(n,e,i.OperandType.Arrow,[t,r,o])}{if(")"===this.current)return this.index+=1,new i.Operand(n,e,i.OperandType.ChildFunc,[t]);let r=this.getArgs(")");return r.splice(0,0,t),new i.Operand(n,e,i.OperandType.ChildFunc,r)}}getIndexOperand(e,t){let r=this.getExpression(void 0,void 0,"]"),n=new i.Operand(t,e,i.OperandType.Var);return new i.Operand(t,"[]",i.OperandType.Operator,[n,r])}getEnum(e,t){if(e.includes(".")&&this.model.isEnum(e)){let r=e.split("."),n=r[0],o=r[1],a=this.model.getEnumValue(n,o);return new i.Operand(t,a,i.OperandType.Const,[],s.Type.get(e))}{let r=this.model.getEnum(e),n=[];for(let e in r){let o=r[e],a=new i.Operand(t,e,i.OperandType.KeyVal,[new i.Operand(t,o,i.OperandType.Const,[],s.Type.get(o))]);n.push(a)}return new i.Operand(t,"obj",i.OperandType.Obj,n)}}}t.Parser=o;class a{constructor(e){this.model=e}parse(e){return new o(this.model,e).parse()}}t.ExpressionParse=a},332:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperandSerializerImpl=void 0;let n=r(8169),i=r(8490);class s{clone(e){let t=this.serialize(e);return this.deserialize(t)}serialize(e){return JSON.stringify(this._serialize(e))}deserialize(e){return this._deserialize(JSON.parse(e))}_serialize(e){let t=[];for(let r of e.children)t.push(this._serialize(r));return{pos:e.pos,name:e.name,children:t,number:e.number,type:e.type,returnType:void 0!==e.returnType?i.Type.stringify(e.returnType):void 0}}_deserialize(e){let t=[];if(e.children)for(let r of e.children){let e=this._deserialize(r);t.push(e)}let r=new n.Operand(e.pos,e.name,n.OperandType[e.type],t,void 0!==e.returnType?i.Type.to(e.returnType):void 0);return r.number=e.number,r}}t.OperandSerializerImpl=s},6376:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TypeServiceImpl=void 0;let n=r(8169),i=r(8490);class s{constructor(e){this.model=e}getType(e){return this.solve(e),e.returnType||i.Type.any}solve(e){this.solveType(e),this.solveTemplate(e),this.setUndefinedAsAny(e)}solveType(e){if(e.type!==n.OperandType.Const&&e.type!==n.OperandType.Var&&e.type!==n.OperandType.Template&&e.type!==n.OperandType.Env&&e.type!==n.OperandType.Default&&e.type!==n.OperandType.Return&&e.type!==n.OperandType.Break){if(e.type===n.OperandType.List)this.solveArray(e);else if(e.type===n.OperandType.Obj)this.solveObject(e);else if(e.type===n.OperandType.Arrow)this.solveArrow(e);else if(e.type===n.OperandType.Operator||e.type===n.OperandType.ChildFunc||e.type===n.OperandType.CallFunc)this.solveOperator(e);else if(e.type===n.OperandType.Property)this.solveProperty(e);else if(e.type===n.OperandType.Block)this.solveBlock(e);else if(e.type===n.OperandType.If||e.type===n.OperandType.ElseIf||e.type===n.OperandType.Else||e.type===n.OperandType.For||e.type===n.OperandType.ForIn||e.type===n.OperandType.While||e.type===n.OperandType.Switch||e.type===n.OperandType.Case)this.solveAny(e);else throw Error(`Type: ${e.type} name: ${e.name} not supported`)}}solveTemplate(e){if(e.type!==n.OperandType.Const&&e.type!==n.OperandType.Var&&e.type!==n.OperandType.Template&&e.type!==n.OperandType.Env&&e.type!==n.OperandType.Block&&e.type!==n.OperandType.If&&e.type!==n.OperandType.ElseIf&&e.type!==n.OperandType.Else&&e.type!==n.OperandType.For&&e.type!==n.OperandType.ForIn&&e.type!==n.OperandType.While&&e.type!==n.OperandType.Switch&&e.type!==n.OperandType.Case){if(e.type===n.OperandType.List)this.solveTemplateArray(e);else if(e.type===n.OperandType.Obj)this.solveTemplateObject(e);else if(e.type===n.OperandType.Operator||e.type===n.OperandType.Arrow||e.type===n.OperandType.ChildFunc||e.type===n.OperandType.CallFunc){let t=this.metadata(e);for(let r of(this.hadTemplate(t)&&this.undefinedTypes(e)&&this.solveTemplateOperator(e,t),e.children))this.solveTemplate(r)}else if(e.type===n.OperandType.Property)this.solveTemplateProperty(e);else throw Error(`Type: ${e.type} name: ${e.name} on template not supported`)}}setUndefinedAsAny(e){for(let t of(void 0===e.returnType&&(e.returnType=i.Type.any),e.children))this.setUndefinedAsAny(t)}solveObject(e){let t=[];for(let r of e.children)this.solveType(r.children[0]),r.returnType=r.children[0].returnType,t.push({name:r.name,type:r.children[0].returnType});e.returnType=i.Type.Obj(t)}solveProperty(e){if(this.solveType(e.children[0]),void 0===e.children[0].returnType)e.children[0].returnType=i.Type.List(i.Type.Obj([{name:e.name}]));else if(i.Type.isList(e.children[0].returnType)){let t=e.children[0].returnType.list;if(t.items&&i.Type.isObj(t.items)){let r=t.items.obj.properties.find(t=>t.name===e.name);r&&r.type&&(e.returnType=r.type)}}}solveArray(e){void 0!==e.children&&0!==e.children.length&&(this.solveType(e.children[0]),void 0!==e.children[0].returnType&&(e.returnType=i.Type.List(e.children[0].returnType)))}solveBlock(e){if(void 0!==e.children&&0!==e.children.length)for(let t of e.children)this.solveType(t)}solveAny(e){if(void 0!==e.children&&0!==e.children.length)for(let t of e.children)this.solveType(t)}solveArrow(e){let t=this.model.getFunction(e.name),r=e.children[0],n=e.children.length>1?e.children[1]:void 0,s=e.children.length>2?e.children[2]:void 0;this.solveArray(r);let o=this.getElementType(r);o&&r.returnType&&n&&(n.returnType=o,s&&this.setVariableType(n.name,o,s)),this.isIndeterminateType(t.returnType)||(e.returnType=i.Type.to(t.returnType)),void 0===r.returnType&&t.params[0].type&&!this.isIndeterminateType(t.params[0].type)&&(r.returnType=i.Type.to(t.params[0].type)),s&&t.params[1].type&&!this.isIndeterminateType(t.params[1].type)&&(s.returnType=i.Type.to(t.params[1].type)),s&&this.solveType(s),this.hadTemplate(t)&&this.solveTemplateOperator(e,t)}solveOperator(e){let t=this.metadata(e);if(!this.isIndeterminateType(t.returnType)){let r=this.trySolveFromMetadata(t.returnType);r&&(e.returnType=r)}for(let r=0;r<t.params.length;r++){let n=t.params[r],i=e.children[r];if(void 0===i)break;if(this.isIndeterminateType(n.type))continue;let s=this.trySolveFromMetadata(n.type);s&&(i.returnType=s)}for(let t of e.children)this.solveType(t);this.hadTemplate(t)&&this.solveTemplateOperator(e,t)}trySolveFromMetadata(e){if(void 0!==e){if(i.Type.isPrimitive(e))return i.Type.to(e);if(e.endsWith("[]")){let t=e.substring(0,e.length-2);if(i.Type.isPrimitive(t))return i.Type.List(i.Type.get(t))}}}solveTemplateArray(e){let t=e.children[0].returnType;this.solveTemplate(e.children[0]),e.children[0].returnType&&e.children[0].returnType!==t&&(e.returnType=i.Type.List(e.children[0].returnType))}solveTemplateProperty(e){let t=e.children[0].returnType;if(this.solveTemplate(e.children[0]),void 0!==e.children[0].returnType&&e.children[0].returnType!==t&&i.Type.isList(e.children[0].returnType)){let t=e.children[0].returnType.list;if(i.Type.isObj(t.items)){let r=t.items.obj.properties.find(t=>t.name===e.name);r&&r.type&&(e.returnType=r.type)}}}solveTemplateObject(e){let t=!1;for(let r of e.children){let e=r.children[0],n=e.returnType;this.solveTemplate(e),e.returnType!==n&&(t=!0)}if(t){let t=[];for(let r of e.children)t.push({name:r.name,type:r.children[0].returnType});e.returnType=i.Type.Obj(t)}}solveTemplateOperator(e,t){let r;if(e.returnType&&("T"===t.returnType?r=e.returnType:"T[]"===t.returnType&&i.Type.isList(e.returnType)&&(r=e.returnType.list.items)),void 0===r)for(let n=0;n<t.params.length;n++){let s=t.params[n];if("T"!==s.type&&"T[]"!==s.type)continue;let o=e.children[n];if(void 0===o)break;if(o.returnType){if("T"===s.type){r=o.returnType;break}if("T[]"===s.type&&i.Type.isList(o.returnType)){r=o.returnType.list.items;break}}}if(void 0!==r){void 0===e.returnType&&("T"===t.returnType?e.returnType=r:"T[]"===t.returnType&&(e.returnType=i.Type.List(r)));for(let n=0;n<t.params.length;n++){let s=t.params[n];if("T"!==s.type&&"T[]"!==s.type)continue;let o=e.children[n];if(void 0===o)break;void 0===o.returnType&&("T"===s.type?o.returnType=r:"T[]"===s.type&&(o.returnType=i.Type.List(r)))}}}getElementType(e){return e.returnType?e.returnType.list.items:void 0}setVariableType(e,t,r){for(let i of(r.type===n.OperandType.Var&&r.name===e&&(r.returnType=t),r.children))i.type===n.OperandType.Arrow&&i.children[1].name===e||this.setVariableType(e,t,i)}isIndeterminateType(e){return void 0===e||["T","T[]","any","any[]"].includes(e)}hadTemplate(e){return"T"===e.returnType||"T[]"===e.returnType||void 0!==e.params.find(e=>"T"===e.type||"T[]"===e.type)}undefinedTypes(e){return void 0===e.returnType||void 0!==e.children.find(e=>void 0===e.returnType)}metadata(e){return e.type===n.OperandType.Operator?this.model.getOperator(e.name,e.children.length):this.model.getFunction(e.name)}}t.TypeServiceImpl=s},2957:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperandBuild=void 0;class r{constructor(){this.builders={}}add(e,t){return this.builders[e]=t,this}get(e){return this.builders[e]}build(e,t="expression"){try{return this.get(t).build(e)}catch(r){throw Error(`${t} ${e} expression  error: ${r}`)}}}t.OperandBuild=r},7652:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperandClone=void 0;let n=r(8169);class i{constructor(e){this.factories=e}getFactory(e){var t;let r=null===(t=this.factories.find(t=>t[0]===e))||void 0===t?void 0:t[1];if(void 0===r)throw Error(`Factory ${e} not found`);return r}clone(e,t){let r=this.getFactory(t);return this._clone(e,r)}_clone(e,t){let r=[];for(let n of e.children)r.push(this._clone(n,t));let i=new n.Operand(e.pos,e.name,e.type,r,e.returnType);return i.id=e.id,i.evaluator=t.create(i),i}}t.OperandClone=i},9636:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperandComplete=void 0;class r{constructor(e){this.evaluatorFactory=e}complete(e){return this._complete(e),e}_complete(e,t=0,r){let n=r?r+"."+t:t.toString();if(e.children)for(let t=0;t<e.children.length;t++){let r=e.children[t];this._complete(r,t,n)}e.id=n,e.evaluator=this.evaluatorFactory.create(e)}}t.OperandComplete=r},9063:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperandNormalize=void 0;let n=r(8169);class i{constructor(e){this.model=e}normalize(e){if(e.type!==n.OperandType.Var||0!==e.children.length)return this.normalizeOperand(e),e;{let t=new n.Operand(e.pos,"p",n.OperandType.Var),r=new n.Operand(e.pos,"p",n.OperandType.Var),i=new n.Operand(e.pos,"map",n.OperandType.Arrow,[e,t,r]);return this.normalizeOperand(i),i}}normalizeOperand(e){if(e.type===n.OperandType.Arrow||e.type===n.OperandType.ChildFunc||e.type===n.OperandType.CallFunc){let t=this.model.functionAlias.find(t=>t[0]===e.name);t&&(e.name=t[1])}else if(e.type===n.OperandType.Operator){let t=this.model.operatorAlias.find(t=>t[0]===e.name);t&&(e.name=t[1])}for(let t of e.children)this.normalizeOperand(t)}}t.OperandNormalize=i},7094:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperandReduce=void 0;let n=r(8169);class i{constructor(e,t){this.model=e,this.constBuilder=t}reduce(e){if(e.type===n.OperandType.Operator)return this.reduceOperand(e);if(e.type===n.OperandType.CallFunc){let t=null;if(this.model.isFunction(e.name))t=this.model.getFunction(e.name);else{let r=e.name.split("."),n=r[r.length-1];t=this.model.getFunction(n)}if(t&&t.deterministic)return this.reduceOperand(e)}return e}reduceOperand(e){let t=!0;for(let r of e.children)if(r.type!==n.OperandType.Const){t=!1;break}if(t){let t=e.eval(new n.Context),r=this.constBuilder.build(e.pos,t);return r.id=e.id,r}for(let t=0;t<e.children.length;t++){let r=e.children[t];e.children[t]=this.reduce(r)}return e}}t.OperandReduce=i},2373:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5368:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PrototypeEvaluator=t.Evaluator=void 0;class r{constructor(e){this.operand=e}async evalAsyncChildren(e){let t=[];for(let r of this.operand.children)t.push(r.evalAsync(e));return Promise.all(t)}isAsync(){for(let e of this.operand.children)if(e.isAsync())return!0;return!1}}t.Evaluator=r;class n{constructor(e){this.operand=e}}t.PrototypeEvaluator=n},5051:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(4866),t),i(r(5368),t),i(r(2373),t)},4866:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7760:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConstBuilderImpl=void 0;let n=r(8169),i=r(8490),s=r(5806);class o{build(e,t){let r=new n.Operand(e,t,n.OperandType.Const,[],i.Type.get(t));return r.evaluator=new s.ConstEvaluator(r),r}}t.ConstBuilderImpl=o},5806:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionEvaluatorFactoryBuilder=t.NotImplementedEvaluator=t.TemplateEvaluator=t.EnvEvaluator=t.VarEvaluator=t.ConstEvaluator=void 0;let n=r(9827),i=r(8169),s=r(5051),o=r(8490),a=r(7887);class l extends s.Evaluator{eval(){if(void 0===this.operand.returnType)return this.operand.name;switch(this.operand.returnType.primitive){case o.Primitive.string:return this.operand.name;case o.Primitive.boolean:return!!this.operand.name;case o.Primitive.integer:case o.Primitive.decimal:return parseFloat(this.operand.name);default:return this.operand.name}}async evalAsync(){return Promise.resolve(this.eval())}isAsync(){return!1}}t.ConstEvaluator=l;class d{build(e){return new l(e)}}class u extends s.Evaluator{eval(e){return e.data.get(this.operand.name)}async evalAsync(e){return Promise.resolve(this.eval(e))}isAsync(){return!1}}t.VarEvaluator=u;class p{build(e){return new u(e)}}class h extends s.Evaluator{constructor(e,t,r){super(e),this.operand=e,this._function=t,this._isAsync=r}eval(e){let t=[];for(let r of this.operand.children)t.push(r.eval(e));return this._function(...t)}async evalAsync(e){return Promise.resolve(this.eval(e))}isAsync(){return this._isAsync}}class c{constructor(e){this.model=e}build(e){let t=this.model.getOperator(e.name,e.children.length);if(t.custom)return t.custom.clone(e);if(void 0!==t.function)return new h(e,t.function,t.async);throw Error(`Operator ${e.name} not implemented`)}}class f{constructor(e){this.model=e}build(e){let t=this.model.getFunction(e.name);if(t.custom)return t.custom.clone(e);if(void 0!==t.function)return new h(e,t.function,t.async);throw Error(`Function ${e.name} not implemented`)}}class v extends f{}class y extends f{}class m extends s.Evaluator{eval(){return process.env[this.operand.name]}async evalAsync(){return Promise.resolve(this.eval())}isAsync(){return!1}}t.EnvEvaluator=m;class g{build(e){return new m(e)}}class b{constructor(e){this.context=e}replace(e){let t=process.env[e];return void 0===t&&this.context.data&&(t=this.context.data.get(e)),void 0===t?e:t}}class w extends s.Evaluator{eval(e){return n.h3lp.utils.template(this.operand.name.toString(),new b(e))}async evalAsync(e){return Promise.resolve(this.eval(e))}isAsync(){return!1}}t.TemplateEvaluator=w;class O{build(e){return new w(e)}}class T extends s.Evaluator{eval(e){let t=this.operand.children[0].eval(e);return null==t?null:n.h3lp.obj.getValue(t,this.operand.name)}async evalAsync(e){let t=this.operand.children[0].evalAsync(e);return null==t?null:n.h3lp.obj.getValue(t,this.operand.name)}isAsync(){return this.operand.children[0].isAsync()}}class x{build(e){return new T(e)}}class E extends s.Evaluator{eval(e){let t=[];for(let r=0;r<this.operand.children.length;r++)t.push(this.operand.children[r].eval(e));return t}async evalAsync(e){let t=await this.evalAsyncChildren(e),r={};for(let e=0;e<t.length;e++)r[this.operand.children[e].name]=t;return r}}class _{build(e){return new E(e)}}class j extends s.Evaluator{eval(e){let t={};for(let r of this.operand.children)t[r.name]=r.children[0].eval(e);return t}async evalAsync(e){let t=await this.evalAsyncChildren(e),r={};for(let e=0;e<t.length;e++)r[this.operand.children[e].name]=t;return r}}class A{build(e){return new j(e)}}class F extends s.Evaluator{eval(e){let t=null;for(let r=0;r<this.operand.children.length;r++)t=this.operand.children[r].eval(e);return t}async evalAsync(e){return this.evalAsyncChildren(e)}}class P{build(e){return new F(e)}}class C extends s.Evaluator{eval(e){if(this.operand.children[0].eval(e))return this.operand.children[1].eval(e);if(this.operand.children.length>2)for(let t=2;t<this.operand.children.length;t++){if(this.operand.children[t].type!==i.OperandType.ElseIf)return this.operand.children[t].eval(e);if(this.operand.children[t].children[0].eval(e))return this.operand.children[t].children[1].eval(e)}}async evalAsync(e){if(await this.operand.children[0].evalAsync(e))return this.operand.children[1].evalAsync(e);if(this.operand.children.length>2)for(let t=2;t<this.operand.children.length;t++){if(this.operand.children[t].type!==i.OperandType.ElseIf)return this.operand.children[t].evalAsync(e);if(this.operand.children[t].children[0].eval(e))return this.operand.children[t].children[1].evalAsync(e)}}}class ${build(e){return new C(e)}}class S extends s.Evaluator{eval(e){let t=this.operand.children[0].eval(e);for(let r=1;r<this.operand.children.length;r++){let n=this.operand.children[r];if(n.type===i.OperandType.Case){if(n.name===t)return n.children[0].eval(e)}else if(n.type===i.OperandType.Default)return n.children[0].eval(e)}}async evalAsync(e){let t=await this.operand.children[0].evalAsync(e);for(let r=1;r<this.operand.children.length;r++){let n=this.operand.children[r];if(n.type===i.OperandType.Case){if(n.name===t)return await n.children[0].evalAsync(e)}else if(n.type===i.OperandType.Default)return await n.children[0].evalAsync(e)}}}class k{build(e){return new S(e)}}class M extends s.Evaluator{eval(e){let t=null,r=this.operand.children[0],n=this.operand.children[1];for(;r.eval(e);)t=n.eval(e);return t}async evalAsync(e){let t=null,r=this.operand.children[0],n=this.operand.children[1];for(;await r.evalAsync(e);)t=await n.evalAsync(e);return t}}class D{build(e){return new M(e)}}class B extends s.Evaluator{eval(e){let t=null,r=this.operand.children[0],n=this.operand.children[1],i=this.operand.children[2],s=this.operand.children[3];for(r.eval(e);n.eval(e);i.eval(e))t=s.eval(e);return t}async evalAsync(e){let t=null,r=this.operand.children[0],n=this.operand.children[1],i=this.operand.children[2],s=this.operand.children[3];for(await r.evalAsync(e);await n.evalAsync(e);await i.evalAsync(e))t=await s.evalAsync(e);return t}}class I{build(e){return new B(e)}}class N extends s.Evaluator{eval(e){let t=null,r=this.operand.children[0],n=this.operand.children[1].eval(e),i=this.operand.children[2];for(let s=0;s<n.length;s++){let o=n[s];e&&e.data.set(r.name,o),t=i.eval(e)}return t}async evalAsync(e){let t=null,r=this.operand.children[0],n=await this.operand.children[1].evalAsync(e),i=this.operand.children[2];for(let s=0;s<n.length;s++){let o=n[s];e&&e.data.set(r.name,o),t=await i.evalAsync(e)}return t}}class L{build(e){return new N(e)}}class V extends s.Evaluator{eval(){throw Error("NotImplemented")}async evalAsync(){throw Error("NotImplemented")}isAsync(){return!1}}t.NotImplementedEvaluator=V;class H{build(e){return new V(e)}}class R{build(e){return new V(e)}}class z{build(e){return new V(e)}}class U{build(e){return new V(e)}}class q{build(e){return new V(e)}}class W{build(e){return new V(e)}}class J{build(e){return new V(e)}}class K{build(e){return new V(e)}}class G{build(e){return new V(e)}}class Y{build(e){return new V(e)}}class Z{build(e){return new V(e)}}class X{build(e){return new V(e)}}class Q{constructor(e){this.model=e}build(){return new a.EvaluatorFactoryImpl().add(i.OperandType.Const,new d).add(i.OperandType.Var,new p).add(i.OperandType.Operator,new c(this.model)).add(i.OperandType.CallFunc,new f(this.model)).add(i.OperandType.ChildFunc,new v(this.model)).add(i.OperandType.Arrow,new y(this.model)).add(i.OperandType.Env,new g).add(i.OperandType.Template,new O).add(i.OperandType.Property,new x).add(i.OperandType.List,new _).add(i.OperandType.Obj,new A).add(i.OperandType.KeyVal,new Y).add(i.OperandType.Block,new P).add(i.OperandType.If,new $).add(i.OperandType.Else,new Z).add(i.OperandType.ElseIf,new X).add(i.OperandType.Switch,new k).add(i.OperandType.While,new D).add(i.OperandType.For,new I).add(i.OperandType.ForIn,new L).add(i.OperandType.Break,new H).add(i.OperandType.Continue,new R).add(i.OperandType.Func,new z).add(i.OperandType.Return,new U).add(i.OperandType.Try,new q).add(i.OperandType.Catch,new W).add(i.OperandType.Throw,new J).add(i.OperandType.Default,new K).add(i.OperandType.Case,new G)}}t.ExpressionEvaluatorFactoryBuilder=Q},6099:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TaskEvaluatorFactoryBuilder=void 0;let n=r(9827),i=r(5051),s=r(8169),o=r(5806),a=r(7887);class l{build(e){return new o.ConstEvaluator(e)}}class d{build(e){return new o.VarEvaluator(e)}}class u{build(e){return new o.EnvEvaluator(e)}}class p{build(e){return new o.TemplateEvaluator(e)}}class h{build(e){return new o.NotImplementedEvaluator(e)}}class c{build(e){return new o.NotImplementedEvaluator(e)}}class f{build(e){return new o.NotImplementedEvaluator(e)}}class v extends i.Evaluator{eval(e){let t=this.operand.children[0].eval(e);return null==t?null:n.h3lp.obj.getValue(t,this.operand.name)}async evalAsync(e){return Promise.resolve(this.eval(e))}}class y{build(e){return new v(e)}}class m{constructor(e){this.operand=e}solveChildren(e,t){if(void 0===t)throw Error("step undefined");for(let r=t.values.length-1;r<this.operand.children.length;r++){let n=this.operand.children[r].eval(e);if(e.token.isBreak)return n;t.values.push(n)}return t.values}async evalAsync(e){return Promise.resolve(this.eval(e))}}class g extends i.Evaluator{constructor(e,t){super(e),this.operand=e,this.child=t}eval(e){if(void 0===this.operand.id)throw Error(`Operand ${this.operand.name} id undefined`);let t=e.token.stack[this.operand.id];void 0===t&&(t=new s.Step(this.operand.name,this.operand.id),e.token.stack[this.operand.id]=t);let r=this.child.eval(e,t);return e.token.isBreak||delete e.token.stack[this.operand.id],r}async evalAsync(e){return Promise.resolve(this.eval(e))}}class b extends m{eval(e,t){return this.solveChildren(e,t)}}class w{build(e){return new b(e)}}class O extends m{eval(e,t){let r=this.solveChildren(e,t);if(e.token.isBreak)return r;let n={};for(let e=0;e<r.length;e++)n[this.operand.children[e].name]=r;return n}}class T{build(e){return new O(e)}}class x extends m{constructor(e,t){super(e),this.operand=e,this._function=t}eval(e,t){let r=this.solveChildren(e,t);return e.token.isBreak?r:this._function(...r)}}class E{constructor(e){this.model=e}build(e){let t=this.model.getOperator(e.name,e.children.length);if(t.custom)return t.custom.clone(e);if(void 0!==t.function)return new g(e,new x(e,t.function));throw Error(`Function ${name} not implemented`)}}class _{constructor(e){this.model=e}build(e){let t=this.model.getFunction(e.name);if(t.custom)return t.custom.clone(e);if(void 0!==t.function)return new g(e,new x(e,t.function));throw Error(`Function ${name} not implemented`)}}class j extends _{}class A extends _{}class F extends m{eval(e,t){let r=this.solveChildren(e,t);return e.token.isBreak?r:r.length>0?r[r.length-1]:null}}class P{build(e){return new F(e)}}class C extends m{eval(e,t){if(void 0===t)throw Error("step undefined");if(0===t.values.length){let r=this.operand.children[0].eval(e);if(e.token.isBreak)return r;t.values.push(r)}if(t.values[0]){let r=this.operand.children[1].eval(e);return e.token.isBreak||t.values.push(r),r}if(this.operand.children.length>2){let r;for(let n=t.values.length-1;n<this.operand.children.length&&(this.operand.children[n].type===s.OperandType.ElseIf?this.operand.children[n].children[0].eval(e)&&(r=this.operand.children[n].children[1].eval(e)):r=this.operand.children[n].eval(e),!e.token.isBreak);n++)t.values.push(r);return r}}}class ${build(e){return new C(e)}}class S extends m{eval(e,t){if(void 0===t)throw Error("step undefined");let r=this.operand.children[0],n=this.operand.children[1],i=null;if(0===t.values.length){let n=r.eval(e);if(e.token.isBreak)return n;t.values.push(n)}for(;t.values[0];){if(1===t.values.length){if(i=n.eval(e),e.token.isBreak)return i;t.values.push(i)}t.values=[];let s=r.eval(e);if(e.token.isBreak)return s;t.values.push(s)}return i}}class k{build(e){return new S(e)}}class M extends m{eval(e,t){if(void 0===t)throw Error("step undefined");let r=null,n=this.operand.children[0],i=this.operand.children[1],s=this.operand.children[2],o=this.operand.children[3];if(0===t.values.length){let r=n.eval(e);if(e.token.isBreak)return r;t.values.push(r)}if(1===t.values.length){let r=i.eval(e);if(e.token.isBreak)return r;t.values.push(r)}for(;t.values[1];){if(2===t.values.length){if(r=o.eval(e),e.token.isBreak)return r;t.values.push(r)}if(3===t.values.length){let r=s.eval(e);if(e.token.isBreak)return r;t.values.push(r)}t.values=[t.values[0]];let n=i.eval(e);if(e.token.isBreak)return n;t.values.push(n)}return r}}class D{build(e){return new M(e)}}class B extends m{eval(e,t){if(void 0===t)throw Error("step undefined");let r=null,n=this.operand.children[0],i=this.operand.children[1],s=this.operand.children[2],o=[];if(0===t.values.length){if(o=i.eval(e),e.token.isBreak)return o;t.values.push(o)}for(let i=t.values.length-1;i<o.length;i++){let a=o[i];if(e&&e.data.set(n.name,a),r=s.eval(e),e.token.isBreak)break;t.values.push(r)}return r}}class I{build(e){return new B(e)}}class N extends m{eval(e,t){let r;if(void 0===t)throw Error("step undefined");if(0===t.values.length){if(r=this.operand.children[0].eval(e),e.token.isBreak)return r;t.values.push(r)}else r=t.values[0];for(let t=1;t<this.operand.children.length;t++){let n=this.operand.children[t];if(n.type===s.OperandType.Case){if(n.name===r)return n.children[0].eval(e)}else if(n.type===s.OperandType.Default)return n.children[0].eval(e)}}}class L{build(e){return new N(e)}}class V{build(e){return new o.NotImplementedEvaluator(e)}}class H{build(e){return new o.NotImplementedEvaluator(e)}}class R{build(e){return new o.NotImplementedEvaluator(e)}}class z{build(e){return new o.NotImplementedEvaluator(e)}}class U{constructor(e){this.model=e}build(){return new a.EvaluatorFactoryImpl().add(s.OperandType.Const,new l).add(s.OperandType.Var,new d).add(s.OperandType.Operator,new E(this.model)).add(s.OperandType.CallFunc,new _(this.model)).add(s.OperandType.ChildFunc,new j(this.model)).add(s.OperandType.Arrow,new A(this.model)).add(s.OperandType.Env,new u).add(s.OperandType.Template,new p).add(s.OperandType.Property,new y).add(s.OperandType.List,new w).add(s.OperandType.Obj,new T).add(s.OperandType.Block,new P).add(s.OperandType.If,new $).add(s.OperandType.Switch,new L).add(s.OperandType.While,new k).add(s.OperandType.For,new D).add(s.OperandType.ForIn,new I).add(s.OperandType.Break,new h).add(s.OperandType.Continue,new c).add(s.OperandType.Func,new V).add(s.OperandType.Return,new f).add(s.OperandType.Try,new H).add(s.OperandType.Catch,new R).add(s.OperandType.Throw,new z)}}t.TaskEvaluatorFactoryBuilder=U},4217:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperandFacadeBuilder=void 0;let n=r(2716),i=r(1728),s=r(322),o=r(332),a=r(2957),l=r(7652),d=r(7760),u=r(5806),p=r(9827),h=r(7887),c=r(6099);class f{constructor(e,t){this.model=e,this.h3lp=t}build(){let e=new d.ConstBuilderImpl,t=new u.ExpressionEvaluatorFactoryBuilder(this.model).build(),r=new c.TaskEvaluatorFactoryBuilder(this.model).build(),f=new l.OperandClone([["expression",t],["task",r]]),v=new s.ParameterServiceImpl,y=new o.OperandSerializerImpl,m=new a.OperandBuild().add("expression",new i.OperandBuilderCacheDecorator(new n.OperandBuilderImpl(t,this.model,e),new p.MemoryCache,y,this.h3lp.utils)).add("task",new i.OperandBuilderCacheDecorator(new n.OperandBuilderImpl(r,this.model,e),new p.MemoryCache,y,this.h3lp.utils));return new h.OperandFacadeImpl(e,v,m,f)}}t.OperandFacadeBuilder=f},4426:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperandHelper=void 0;let n=r(8169);class i{constructor(e){this.constBuilder=e}toExpression(e){let t=[];switch(e.type){case n.OperandType.Const:case n.OperandType.Var:case n.OperandType.Property:t.push(e.name);break;case n.OperandType.List:t.push("[");for(let r=0;r<e.children.length;r++)r>0&&t.push(","),t.push(this.toExpression(e.children[r]));t.push("]");break;case n.OperandType.KeyVal:t.push(e.name+":"),t.push(this.toExpression(e.children[0]));break;case n.OperandType.Obj:t.push("{");for(let r=0;r<e.children.length;r++)r>0&&t.push(","),t.push(this.toExpression(e.children[r]));t.push("}");break;case n.OperandType.Operator:1===e.children.length?(t.push(e.name),t.push(this.toExpression(e.children[0]))):2===e.children.length&&(t.push("("),t.push(this.toExpression(e.children[0])),t.push(e.name),t.push(this.toExpression(e.children[1])),t.push(")"));break;case n.OperandType.CallFunc:t.push(e.name),t.push("(");for(let r=0;r<e.children.length;r++)r>0&&t.push(","),t.push(this.toExpression(e.children[r]));t.push(")");break;case n.OperandType.ChildFunc:t.push(this.toExpression(e.children[0])),t.push("."+e.name),t.push("(");for(let r=1;r<e.children.length;r++)r>1&&t.push(","),t.push(this.toExpression(e.children[r]));t.push(")");break;case n.OperandType.Arrow:t.push(this.toExpression(e.children[0])),t.push("."+e.name),t.push("("),t.push(e.children[1].name),t.push("=>"),t.push(this.toExpression(e.children[2])),t.push(")");break;default:throw Error("node: "+e.type+" not supported")}return t.join("")}objectKey(e){let t=Object.keys(e).sort(),r=[];for(let n of t)r.push(n),r.push(e[n].toString());return r.join("|")}getKeys(e,t,r,n){let i=[];for(let s of r){let r="",o=[];for(let i of t){n.data.set(e.name,s);let t=i.children[0].eval(n);if("object"==typeof t)throw Error(`Property value ${i.name} is an object, so it cannot be grouped`);r=""===r?t:`${r}-${t}`,o.push({name:i.name,value:t})}let a=i.find(e=>e.key===r);a?a.items.push(s):i.push({key:r,values:o,items:[s],summarizers:[]})}return i}haveAggregates(e){if(e.type!==n.OperandType.Arrow&&e.type===n.OperandType.CallFunc&&["avg","count","first","last","max","min","sum"].indexOf(e.name)>-1)return!0;if(e.children&&e.children.length>0){for(let t of e.children)if(this.haveAggregates(t))return!0}return!1}findAggregates(e){if(e.type!==n.OperandType.Arrow&&e.type===n.OperandType.CallFunc&&["avg","count","first","last","max","min","sum"].indexOf(e.name)>-1)return[e];if(e.children&&e.children.length>0){let t=[];for(let r of e.children){let e=this.findAggregates(r);e.length>0&&(t=t.concat(e))}return t}return[]}solveAggregates(e,t,r,i){if(r.type!==n.OperandType.Arrow&&r.type===n.OperandType.CallFunc&&["avg","count","first","last","max","min","sum"].indexOf(r.name)>-1){let n;switch(r.name){case"avg":n=this.avg(e,t,r.children[0],i);break;case"count":n=this.count(e,t,r.children[0],i);break;case"first":n=this.first(e,t,r.children[0],i);break;case"last":n=this.last(e,t,r.children[0],i);break;case"max":n=this.max(e,t,r.children[0],i);break;case"min":n=this.min(e,t,r.children[0],i);break;case"sum":n=this.sum(e,t,r.children[0],i)}return this.constBuilder.build(r.pos,n)}if(r.children&&r.children.length>0)for(let n=0;n<r.children.length;n++)r.children[n]=this.solveAggregates(e,t,r.children[n],i);return r}count(e,t,r,n){let i=0;for(let s of e)n.data.set(t.name,s),r.eval(n)&&i++;return i}first(e,t,r,n){for(let i of e)if(n.data.set(t.name,i),r.eval(n))return i;return null}last(e,t,r,n){for(let i=e.length-1;i>=0;i--){let s=e[i];if(n.data.set(t.name,s),r.eval(n))return s}return null}max(e,t,r,n){let i;for(let s of e){n.data.set(t.name,s);let e=r.eval(n);(void 0===i||null!==e&&e>i)&&(i=e)}return i}min(e,t,r,n){let i;for(let s of e){n.data.set(t.name,s);let e=r.eval(n);(void 0===i||null!==e&&e<i)&&(i=e)}return i}avg(e,t,r,n){let i=0;for(let s of e){n.data.set(t.name,s);let e=r.eval(n);null!==e&&(i+=e)}return e.length>0?i/e.length:0}sum(e,t,r,n){let i=0;for(let s of e){n.data.set(t.name,s);let e=r.eval(n);null!==e&&(i+=e)}return i}}t.OperandHelper=i},300:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(4426),t),i(r(4217),t),i(r(7760),t)},6321:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Position=void 0;class r{constructor(e,t){this.ln=e,this.col=t}}t.Position=r},4929:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Context=t.Token=t.Step=t.Data=void 0;let i=r(9827),s=n(r(6113));class o{constructor(e={},t){this.data=e,this.parent=t}newData(){return new o({},this)}getData(e){return void 0!==this.data[e]||null==this.parent?this.data:this.parent.getData(e)||this.data}contains(e){let t=e.split("."),r=this.getData(t[0]);for(let e in t){if(void 0===r[e])return!1;r=r[e]}return!0}get(e){let t=i.h3lp.obj.names(e),r=this.getData(t[0]);return i.h3lp.obj.getValue(r,e)}set(e,t){let r=i.h3lp.obj.names(e),n=this.getData(r[0]);return i.h3lp.obj.setValue(n,e,t)}init(e,t){this.data[e]=t}}t.Data=o;class a{constructor(e,t){this.name=e,this.id=t,this.values=[]}}t.Step=a;class l{constructor(){this.id=s.default.randomUUID(),this.stack={},this.isBreak=!1,this.listeners=[],this.signals=[]}addListener(e){this.isBreak=!0,this.listeners.push(e)}clearListeners(){this.isBreak=!1,this.listeners=[]}addSignal(e){this.signals.push(e)}clearSignals(){this.signals=[]}}t.Token=l;class d{constructor(e,t,r){this.data=e||new o({}),this.token=t||new l,this.parent=r}newContext(){return new d(this.data.newData(),this.token,this)}}t.Context=d},8169:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(6321),t),i(r(4929),t),i(r(4710),t),i(r(5376),t),i(r(5719),t)},4710:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ActionObserver=void 0;class r{constructor(e){this.condition=e}}t.ActionObserver=r},5719:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Operand=t.OperandType=void 0,function(e){e.Const="Const",e.Var="Var",e.Env="Env",e.Property="Property",e.Template="Template",e.KeyVal="KeyVal",e.List="List",e.Obj="Obj",e.Operator="Operator",e.CallFunc="CallFunc",e.Arrow="Arrow",e.ChildFunc="ChildFunc",e.Block="Block",e.If="If",e.ElseIf="ElseIf",e.Else="Else",e.While="While",e.For="For",e.ForIn="ForIn",e.Switch="Switch",e.Case="Case",e.Default="Default",e.Break="Break",e.Continue="Continue",e.Func="Func",e.Return="Return",e.Try="Try",e.Catch="Catch",e.Throw="Throw",e.Args="Args"}(r||(t.OperandType=r={}));class n{constructor(e,t,r,n=[],i){this.pos=e,this.name=t,this.type=r,this.children=n,this.returnType=i}eval(e){if(!this.evaluator)throw Error(`${this.name} evaluator not implemented`);return this.evaluator.eval(e)}async evalAsync(e){if(!this.evaluator)throw Error(`${this.name} evaluator not implemented`);return this.evaluator.evalAsync(e)}isAsync(){return this.children.some(e=>e.isAsync())}async solve(e){return this.isAsync()?await this.evalAsync(e):this.eval(e)}}t.Operand=n},5376:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7791:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExprH3lp=void 0;let n=r(9827),i=r(7943),s=r(300);class o extends n.H3lp{constructor(e){super(e.utils,e.val,e.fs,e.http,e.obj,e.str,e.test,e.array);let t=new s.ConstBuilderImpl;this.operand=new s.OperandHelper(t),this.expression=new i.ExpressionHelper(e.str)}}t.ExprH3lp=o},741:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(7791),t)},9054:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5480:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryCache=void 0;class r{constructor(e=new Map){this.map=e}get(e){return this.map.get(e)}set(e,t){this.map.set(e,t)}delete(e){return this.map.delete(e)}}t.MemoryCache=r},2292:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},555:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.H3lp=void 0;class r{constructor(e,t,r,n,i,s,o,a){this.utils=e,this.val=t,this.fs=r,this.http=n,this.obj=i,this.str=s,this.test=o,this.array=a}}t.H3lp=r},8550:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},832:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(1130),t),i(r(6557),t),i(r(2292),t),i(r(8550),t),i(r(9262),t),i(r(3262),t),i(r(7386),t),i(r(9054),t),i(r(555),t),i(r(5480),t)},9262:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3262:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7386:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1130:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContextReplacer=t.EnvironmentVariableReplacer=void 0;class r{replace(e){return process.env[e]}}t.EnvironmentVariableReplacer=r;class n{constructor(e){this.obj=e}context(e){return this._context=e,this}replace(e){return this.obj.getValue(this._context,e)}}t.ContextReplacer=n},6557:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},4688:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1576:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Autowired=t.Service=t.Sealed=void 0;let n=r(661);t.Sealed=function(e){Object.seal(e),Object.seal(e.prototype)},t.Service=function(e){return function(t){n.Factory.add(e,Object.create(t.prototype))}},t.Autowired=function(e){return function(t,r){let i;Object.defineProperty(t,r,{get:function(){return void 0===i&&(i=n.Factory.get(e)),i}})}}},7055:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Delta=void 0;class r{}t.Delta=r},661:function(e,t,r){var n,i=this&&this.__decorate||function(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;let s=r(1576),o=n=class{static add(e,t){let r=e.split("."),i=r.length-1,s=n.instances;for(let e=0;e<r.length;e++){let n=r[e];if(e===i){s[n]=t;return}void 0===s[n]&&(s[n]={}),s=s[n]}}static get(e){let t=e.split("."),r=n.instances;for(let n of t){if(void 0===r[n])throw Error(`Service ${e} cannot found`);r=r[n]}return r}};t.Factory=o,o.instances={},t.Factory=n=i([s.Sealed],o)},6009:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(4688),t),i(r(7055),t),i(r(1576),t),i(r(7251),t),i(r(661),t)},7251:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9827:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.h3lp=void 0;let s=r(8605);t.h3lp=new s.H3lpBuilder().build(),i(r(6009),t),i(r(832),t),i(r(2280),t)},7621:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayHelper=void 0;let i=r(6009),s=class{unique(e){return[...new Set(e)]}union(e,t){return[...new Set(e.concat(t))]}intersection(e,t){return e.filter(e=>t.includes(e))}difference(e,t){return e.filter(e=>!t.includes(e))}symmetricDifference(e,t){return this.union(this.difference(e,t),this.difference(t,e))}shuffle(e){return e.sort(()=>Math.random()-.5)}chunks(e,t){let r=[];for(let n=0;n<e.length;n+=t){let i=e.slice(n,n+t);r.push(i)}return r}};t.ArrayHelper=s,t.ArrayHelper=n([(0,i.Service)("h3lp.array")],s)},8605:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.H3lpBuilder=void 0;let n=r(832),i=r(7621),s=r(5309),o=r(8880),a=r(2617),l=r(4620),d=r(7948),u=r(613),p=r(6746);class h{build(){let e=new p.Validator,t=new l.StringHelper(e),r=new i.ArrayHelper,h=new s.FsHelper,c=new o.HttpHelper(t),f=new a.ObjectHelper(c,e),v=new u.Utils(e,f),y=new d.TestHelper(v,h,t,f);return new n.H3lp(v,e,h,c,f,t,y,r)}}t.H3lpBuilder=h},5309:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((n=n.apply(e,t||[])).next())})},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FsHelper=void 0;let o=s(r(7147)),a=s(r(1017)),l=r(6009),d=class{exists(e){return i(this,void 0,void 0,function*(){let t=this.resolve(e);return new Promise(e=>{o.default.access(t,t=>{t?e(!1):e(!0)})})})}create(e){return i(this,void 0,void 0,function*(){let t=this.resolve(e);if(!(yield this.exists(t)))return new Promise((e,r)=>{o.default.mkdir(t,{recursive:!0},t=>t?r(t):e())})})}resolve(e){let t=e.trim();return t.startsWith(".")?a.default.join(process.cwd(),e):t.startsWith("~")?t.replace("~",process.env.HOME):e}read(e){return i(this,void 0,void 0,function*(){let t=this.resolve(e);return(yield this.exists(t))?new Promise((e,r)=>{o.default.readFile(t,(t,n)=>t?r(t):e(n.toString("utf8")))}):null})}remove(e){return i(this,void 0,void 0,function*(){let t=this.resolve(e);if(yield this.exists(t))return new Promise((e,r)=>{o.default.unlink(t,t=>t?r(t):e())})})}removeDir(e){return i(this,void 0,void 0,function*(){try{if(!(yield this.lstat(e)).isDirectory()){yield this.remove(e);return}let t=yield this.readdir(e);return yield Promise.all(t.map(t=>i(this,void 0,void 0,function*(){let r=a.default.join(e,t);yield this.removeDir(r)}))),new Promise((t,r)=>{o.default.rmdir(e,e=>e?r(e):t())})}catch(t){console.error(`Error removing directory ${e}: ${t}`)}})}copy(e,t){return i(this,void 0,void 0,function*(){let r=this.resolve(e),n=this.resolve(t);if(!(yield this.exists(r)))throw Error(`not exists ${e}`);return new Promise((e,t)=>{o.default.copyFile(r,n,r=>r?t(r):e())})})}write(e,t){return i(this,void 0,void 0,function*(){let r=this.resolve(e),n=a.default.dirname(r);return(yield this.exists(n))||(yield this.create(n)),new Promise((e,n)=>{o.default.writeFile(r,t,{encoding:"utf8"},t=>t?n(t):e())})})}writeBinary(e,t){return i(this,void 0,void 0,function*(){let r=this.resolve(e),n=a.default.dirname(r);return(yield this.exists(n))||(yield this.create(n)),new Promise((e,n)=>{o.default.writeFile(r,t,t=>t?n(t):e())})})}lstat(e){return i(this,void 0,void 0,function*(){let t=this.resolve(e);return new Promise((e,r)=>{o.default.lstat(t,(t,n)=>t?r(t):e(n))})})}readdir(e){return i(this,void 0,void 0,function*(){let t=this.resolve(e);return new Promise((e,r)=>{o.default.readdir(t,(t,n)=>t?r(t):e(n))})})}isDirectory(e){return i(this,void 0,void 0,function*(){return(yield this.exists(e))?o.default.lstatSync(e).isDirectory():""===a.default.parse(e).ext.toLocaleLowerCase()})}};t.FsHelper=d,t.FsHelper=n([(0,l.Service)("h3lp.fs")],d)},8880:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((n=n.apply(e,t||[])).next())})},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HttpHelper=void 0;let s=i(r(5687)),o=i(r(3685));class a{constructor(e){this.str=e}get(e){return n(this,void 0,void 0,function*(){return new Promise((t,r)=>{let n="",i=("https:"===new URL(e).protocol?s.default:o.default).request(e,e=>{e.on("data",e=>{n+=e.toString()}),e.on("end",()=>{t(n)})});i.on("error",e=>{r(e)}),i.end()})})}decode(e){let t=e;return t.includes("~1")&&(t=this.str.replace(t,"~1","/")),t.includes("~0")&&(t=this.str.replace(t,"~0","~")),t.includes("%")&&(t=decodeURI(t)),t}urlJoin(e,t){if(/(https?:\/\/[^\s]+)/g.test(e))return new URL(t,e).href;let r=t.split("/").filter(e=>""!==e),n=e.split("/").filter(e=>""!==e);return n.splice(0,n.length-r.length).join("/")+"/"+r.join("/")}}t.HttpHelper=a},2280:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(613),t),i(r(6746),t),i(r(5309),t),i(r(8880),t),i(r(2617),t),i(r(4620),t),i(r(7948),t),i(r(7621),t)},2617:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectHelper=void 0;let n=r(9827);class i{constructor(e,t){this.http=e,this.validator=t}clone(e){return e&&"object"==typeof e?JSON.parse(JSON.stringify(e)):e}extends(e,t,r=[]){return null==e?t:null==t?e:this._extends(this.clone(e),t,r)}_extends(e,t,r){if(null==t);else if(Array.isArray(t)){if(0===t.length)return e;if(!Array.isArray(e))return t;if(Array.isArray(t[0]))throw Error("extends array of array not supported");for(let n of t){let t=e.findIndex(e=>e.name===n.name);-1===t?e.push(this.clone(n)):this._extends(e[t],n,r)}}else if("object"==typeof t)for(let n of Object.entries(t)){let t=n[0],i=n[1];null==i||r.includes(t)||(void 0===e[t]?e[t]=this.clone(i):"object"==typeof e[t]&&this._extends(e[t],i,r))}return e}names(e){return"."===e?[e]:e.startsWith("..")?["."].concat(e.substring(2).split(".")):e.startsWith(".")?["."].concat(e.substring(1).split(".")):e.split(".")}getValue(e,t){let r=Array.isArray(t)?t:this.names(t),n=e;for(let e of r)if(Array.isArray(n)){if(this.validator.isPositiveInteger(e)){n=n[parseInt(e)];continue}let t=[];for(let r of n)void 0!==r[e]&&(Array.isArray(r[e])?t=t.concat(r[e]):t.push(r[e]));n=t}else{if(void 0===n[e])return null;n=n[e]}return n}setValue(e,t,r){let n=Array.isArray(t)?t:t.split("."),i=n.length-1,s=e;for(let e=0;e<n.length;e++){let t=n[e];if(Array.isArray(s)&&this.validator.isPositiveInteger(t)){let n=Number(t);if(n>=s.length)return!1;e===i?s[n]=r:s=s[n]}else if(e===i)s[t]=r;else{if(void 0===s[t])return!1;s=s[t]}}return!0}getKeyProperty(e,t=["id","code","name","key"]){let r=Object.keys(e).map(e=>e.toLowerCase());for(let e of t)if(r.includes(e.toLowerCase()))return e}sort(e){let t={};if(null===e)return null;if(Array.isArray(e)){let t=this.getKeyProperty(e[0]);return t?e.map(e=>this.sort(e)).sort((e,r)=>e[t]>r[t]?1:-1):e.map(e=>this.sort(e)).sort((e,t)=>JSON.stringify(e)>JSON.stringify(t)?1:-1)}if("object"==typeof e)for(let r of Object.keys(e).sort())null===e[r]?t[r]=null:Array.isArray(e[r])?t[r]=this.sort(e[r]):"object"==typeof e[r]?t[r]=this.sort(e[r]):t[r]=e[r];return t}equal(e,t,r){if(r.strict)return JSON.stringify(e)===JSON.stringify(t);{let r=this.sort(e),n=this.sort(t);return JSON.stringify(r)===JSON.stringify(n)}}fromEntries(e){if(!Array.isArray(e))return{};let t={};for(let r of e)Array.isArray(r)&&2===r.length&&(t[r[0]]=r[1]);return t}jsonPath(e,t){let r=t.split("/"),n=e;for(let e=0;e<r.length;e++){let t=r[e],i=n[t=this.http.decode(t)];if(void 0===i)return;n=i}return n}createKey(e){if(null===e)return"null";if(Array.isArray(e)){let t=[];for(let r of e)t.push(this.createKey(r));return`[${t.join(",")}]`.toLowerCase()}if("object"!=typeof e)return e;{let t=[];for(let r of Object.entries(e))t.push(`${r[0]}:${this.createKey(r[1])}`);return`{${t.join(",")}}`.toLowerCase()}}find(e,t){if(Array.isArray(e))for(let r of e){let e=this.find(r,t);if(e)return e}else if(null!==e&&"object"==typeof e){if(t(e))return e;for(let r of Object.values(e)){let e=this.find(r,t);if(e)return e}}}filter(e,t){let r=[];if(Array.isArray(e))for(let n of e){let e=this.filter(n,t);e.length>0&&r.push(...e)}else if(null!==e&&"object"==typeof e)for(let n of(t(e)&&r.push(e),Object.values(e))){let e=this.filter(n,t);e.length>0&&r.push(...e)}return r}delta(e,t,r){return this._delta("",e,t,r)}_delta(e,t,r,i){let s=new n.Delta;if(null==t)throw Error("current value can't empty");if("object"!=typeof t)i&&i.ignore&&i.ignore.includes(e)||this._deltaValue(e,"",t,r,s,i||{});else if(Array.isArray(t))i&&i.ignore&&i.ignore.includes(e)||this._deltaArray(e,"",t,r,s,i||{});else{for(let n in t){let o=""===e?n:`${e}.${n}`;if(i&&i.ignore&&i.ignore.includes(o))continue;let a=t[n];null==r?(void 0===s.new&&(s.new=[]),s.new.push({name:n,new:a})):this._deltaValue(""===e?n:`${e}.${n}`,n,a,r[n],s,i||{})}if(void 0!==r||null!==r)for(let n in r){let o=""===e?n:`${e}.${n}`;i&&i.ignore&&i.ignore.includes(o)||void 0!==t[n]||(void 0===s.remove&&(s.remove=[]),s.remove.push({name:n,old:r[n]}))}}return s}_deltaValue(e,t,r,n,i,s){if(void 0===n)void 0===i.new&&(i.new=[]),i.new.push({name:t,new:r});else if(null===n&&null===r)void 0===i.unchanged&&(i.unchanged=[]),i.unchanged.push({name:t,value:n});else if(null!==n&&null===r||null===n&&null!==r)void 0===i.changed&&(i.changed=[]),i.changed.push({name:t,new:r,old:n});else if(Array.isArray(r))this._deltaArray(e,t,r,n,i,s);else if(this.validator.isObject(r)){let o=this._delta(e,r,n,s);this._deltaChange(o)?(void 0===i.changed&&(i.changed=[]),i.changed.push({name:t,new:r,old:n,delta:o})):(void 0===i.unchanged&&(i.unchanged=[]),i.unchanged.push({name:t,value:n}))}else n!==r?(void 0===i.changed&&(i.changed=[]),i.changed.push({name:t,new:r,old:n})):(void 0===i.unchanged&&(i.unchanged=[]),i.unchanged.push({name:t,value:n}))}_deltaArray(e,t,r,i,s,o){if(r&&Array.isArray(r)&&(!i||!Array.isArray(i))){let e=new n.Delta;e.new=r.map((e,t)=>({name:t.toString(),new:e})),void 0===s.children&&(s.children=[]),s.children.push({name:t,type:"array",change:!0,delta:e})}else if(i&&Array.isArray(i)&&(!r||!Array.isArray(r))){let e=new n.Delta;e.remove=i.map((e,t)=>({name:t.toString(),old:e})),void 0===s.children&&(s.children=[]),s.children.push({name:t,type:"array",change:!0,delta:e})}else if(0===r.length&&0===i.length)void 0===s.unchanged&&(s.unchanged=[]),s.unchanged.push({name:t,value:i});else if(r.length>0&&"object"!=typeof r[0]){let e=new n.Delta,o=r.filter(e=>-1===i.indexOf(e)),a=r.filter(e=>-1!==i.indexOf(e)),l=i.filter(e=>-1===r.indexOf(e));for(let t of o)void 0===e.new&&(e.new=[]),e.new.push({name:r.indexOf(t).toString(),new:t});for(let t of l)void 0===e.remove&&(e.remove=[]),e.remove.push({name:i.indexOf(t).toString(),old:t});for(let t of a)void 0===e.unchanged&&(e.unchanged=[]),e.unchanged.push({name:r.indexOf(t).toString(),value:t});let d=o.length+l.length>0;void 0===s.children&&(s.children=[]),s.children.push({name:t,type:"array",change:d,delta:e})}else if(Array.isArray(r[0]))throw Error(`array of array not supported in ${t}`);else{let n=this._deltaArrayOfObject(e,t,r,i,o),a=this._deltaChange(n);void 0===s.children&&(s.children=[]),s.children.push({name:t,type:"array",change:a,delta:n})}}_deltaArrayOfObject(e,t,r,i,s){let o=Object.keys(r[0]).find(e=>["id","code","name","key"].includes(e.toLowerCase()));if(void 0===o)throw Error(`key not found in ${e}`);let a=new n.Delta;for(let n of r){let r=i.find(e=>e[o]===n[o]);if(void 0===r)void 0===a.new&&(a.new=[]),a.new.push({name:t,new:n});else{let i=this._delta(e,n,r,s);this._deltaChange(i)?(void 0===a.changed&&(a.changed=[]),a.changed.push({name:t,new:n,old:r,delta:i})):(void 0===a.unchanged&&(a.unchanged=[]),a.unchanged.push({name:t,value:r}))}}for(let e of i)void 0===r.find(t=>t[o]===e[o])&&(void 0===a.remove&&(a.remove=[]),a.remove.push({name:t,old:e}));return a}_deltaChange(e){if((e.changed?e.changed.length:0)+(e.remove?e.remove.length:0)+(e.new?e.new.length:0)>0)return!0;if(!e.children)return!1;for(let t of e.children)if(t.change)return!0;return!1}}t.ObjectHelper=i},4620:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StringHelper=void 0;class r{constructor(e){this.validator=e,this._plural={"(quiz)$":"$1zes","^(ox)$":"$1en","([m|l])ouse$":"$1ice","(matr|vert|ind)ix|ex$":"$1ices","(x|ch|ss|sh)$":"$1es","([^aeiouy]|qu)y$":"$1ies","(hive)$":"$1s","(?:([^f])fe|([lr])f)$":"$1$2ves","(shea|lea|loa|thie)f$":"$1ves",sis$:"ses","([ti])um$":"$1a","(tomat|potat|ech|her|vet)o$":"$1oes","(bu)s$":"$1ses","(alias)$":"$1es","(octop)us$":"$1i","(ax|test)is$":"$1es","(us)$":"$1es","([^s]+)$":"$1s"},this._singular={"(quiz)zes$":"$1","(matr)ices$":"$1ix","(vert|ind)ices$":"$1ex","^(ox)en$":"$1","(alias)es$":"$1","(octop|vir)i$":"$1us","(cris|ax|test)es$":"$1is","(shoe)s$":"$1","(o)es$":"$1","(bus)es$":"$1","([m|l])ice$":"$1ouse","(x|ch|ss|sh)es$":"$1","(m)ovies$":"$1ovie","(s)eries$":"$1eries","([^aeiouy]|qu)ies$":"$1y","([lr])ves$":"$1f","(tive)s$":"$1","(hive)s$":"$1","(li|wi|kni)ves$":"$1fe","(shea|loa|lea|thie)ves$":"$1f","(^analy)ses$":"$1sis","((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$":"$1$2sis","([ti])a$":"$1um","(n)ews$":"$1ews","(h|bl)ouses$":"$1ouse","(corpse)s$":"$1","(us)es$":"$1",s$:""},this._uncountable=["sheep","fish","deer","moose","series","species","money","rice","information","equipment","bison","cod","offspring","pike","salmon","shrimp","swine","trout","aircraft","hovercraft","spacecraft","sugar","tuna","you","wood"],this._irregular={move:"moves",foot:"feet",goose:"geese",sex:"sexes",child:"children",man:"men",tooth:"teeth",person:"people"}}toString(e){return this.validator.isNull(e)?"":e.toString()}replace(e,t,r){return e.split(t).join(r)}equal(e,t,r={}){return r.normalize?(e=this.normalize(e),t=this.normalize(t),e===t):r.ignoreCase?e.toLowerCase()===t.toLowerCase():e===t}concat(e){if(!e||0===e.length)return"";if("string"==typeof e[0])return"".concat(...e);if(Array.isArray(e[0]))return[].concat(...e);{let t=[];for(let r of e)t.push(r);return t}}capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}initCap(e){let t;let r=e.split(" "),n=[];for(t=0;t<r.length;t++)n.push(this.capitalize(r[t]));return n.join(" ")}isUpperCase(e){let t=e.charCodeAt(0);return t>=65&&t<=90}isLowerCase(e){let t=e.charCodeAt(0);return t>=97&&t<=122}isCharacter(e){let t=e.charCodeAt(0);return t>=65&&t<=90||t>=97&&t<=122}isDigit(e){let t=e.charCodeAt(0);return t>=48&&t<=57}notation(e,t="camel"){let r=Array.from(e),n=[],i="pascal"===t,s=!1,o=r.length;for(let e=0;e<o;e++){let o=r[e],a=this.isUpperCase(o);if(["_",".","-"," "].includes(o)){n.length>0&&(i=!0,s=!1);continue}a&&"camel"===t&&0===n.length?o=o.toLowerCase():s&&a?o=o.toLowerCase():i&&(o=this.capitalize(o),i=!1),n.push(o),s=a}return n.join("")}normalize(e,t={}){if(null==e)return e;let r=[],n=Array.from(e),i=n.length;for(let e=0;e<i;e++){let i=n[e].charCodeAt(0);if(i>47&&i<58)r.push(String.fromCharCode(i));else if(i>96&&i<123)t.toUpper?r.push(String.fromCharCode(i-32)):r.push(String.fromCharCode(i));else if(i>64&&i<91)t.toLower?r.push(String.fromCharCode(i+32)):r.push(String.fromCharCode(i));else{if(i<48||i>90&&i<97||i>122&&i<128)continue;[216,248,7443].includes(i)?r.push("0"):[604,605,8488,42923].includes(i)?r.push("3"):[224,225,226,227,228,229,257,259,261,395,396,462,513,515,551,593,592,7681,867,7841,7843,11365].includes(i)?r.push(t.toUpper?"A":"a"):[384,385,386,387,7683,7687,8468,7685,595].includes(i)?r.push(t.toUpper?"B":"b"):[231,263,265,269,392,596,597,267,872,8580].includes(i)?r.push(t.toUpper?"C":"c"):[271,545,598,599,273,873,7691,7693,7695,7697,7699,8518].includes(i)?r.push(t.toUpper?"D":"d"):[232,233,234,235,275,277,279,281,283,339,477,517,519,553,571,572,583,600,868,7705,7707,7865,7867,7869,8493,8495,8519].includes(i)?r.push(t.toUpper?"E":"e"):[402,589,619,620,607,7711,7835].includes(i)?r.push(t.toUpper?"F":"f"):[285,287,289,291,485,487,501,608,609,7713,8458,42924].includes(i)?r.push(t.toUpper?"G":"g"):[293,295,543,614,686,688,874,7715,7717,7721,8341,7723,42893,7719].includes(i)?r.push(t.toUpper?"H":"h"):[297,299,301,303,464,521,523,236,237,238,239,616,7522,869,7725,7433,8305,8520,7883].includes(i)?r.push(t.toUpper?"I":"i"):[585,669,690,8464,8521].includes(i)?r.push(t.toUpper?"J":"j"):[409,489,670,7729,7733,8342].includes(i)?r.push(t.toUpper?"K":"k"):[314,316,318,320,322,410,564,621,737,8343,7735,7741,8466,8467,7739].includes(i)?r.push(t.toUpper?"L":"l"):[623,624,625,7455,875,7743,7745,7747,8344].includes(i)?r.push(t.toUpper?"M":"m"):[241,324,326,328,414,505,626,627,565,7749,7751,7753,7755,8345].includes(i)?r.push(t.toUpper?"N":"n"):[242,243,244,245,246,333,335,337,417,466,525,527,7439,7441,870,7885,8500,559,629,7887].includes(i)?r.push(t.toUpper?"O":"o"):[421,7448,7765,7767,8346,8472].includes(i)?r.push(t.toUpper?"P":"p"):[586,587,672].includes(i)?r.push(t.toUpper?"Q":"q"):[341,343,345,529,531,633,634,635,636,637,638,639,7523,691,692,876,7769,7771,7775].includes(i)?r.push(t.toUpper?"R":"r"):[347,349,351,353,537,575,642,738,7777,7779,8347].includes(i)?r.push(t.toUpper?"S":"s"):[355,357,359,427,429,429,573,566,647,648,7451,877,7787,7789,7791,7793,8348,11366].includes(i)?r.push(t.toUpper?"T":"t"):[249,250,251,252,361,363,365,367,369,432,434,468,533,535,651,7452,7453,7454,7524,871,7795,7797,7799,7909,7911].includes(i)?r.push(t.toUpper?"U":"u"):[7456,7525,878,652,7807].includes(i)?r.push(t.toUpper?"V":"v"):[373,653,7457,695].includes(i)?r.push(t.toUpper?"W":"w"):[739,879,7819,7821,10005,10006,10007,10008].includes(i)?r.push(t.toUpper?"X":"x"):[253,255,371,375,563,435,436,591,613,654,655,696,7823,7923,7925,7927,7929].includes(i)?r.push(t.toUpper?"Y":"y"):[378,380,382,438,549,656,657,576,7458,7825,7827,7829].includes(i)?r.push(t.toUpper?"Z":"z"):[192,193,194,195,196,197,256,258,260,461,512,514,550,570,580,649,7424,7680,7840,7842,11373,11375].includes(i)?r.push(t.toLower?"a":"A"):[579,606,665,7427,7682,7684,7686,8492].includes(i)?r.push(t.toLower?"b":"B"):[199,262,264,266,268,390,391,663,7428,7440,7442,8450,8579].includes(i)?r.push(t.toLower?"c":"C"):[270,272,393,394,7429,7690,7692,7694,7696,7698,8517].includes(i)?r.push(t.toLower?"d":"D"):[200,201,202,203,274,276,278,280,282,338,398,400,516,518,552,582,603,7431,7432,7704,7706,7864,7866,7868,8496,8959].includes(i)?r.push(t.toLower?"e":"E"):[401,7710,8497,8498,8526].includes(i)?r.push(t.toLower?"f":"F"):[284,286,288,290,403,484,486,500,610,666,667,7712,8513].includes(i)?r.push(t.toLower?"g":"G"):[292,294,542,668,7714,7716,7718,7720,7722,8459,8460,8461,42922].includes(i)?r.push(t.toLower?"h":"H"):[296,298,300,302,304,407,463,520,522,204,205,206,207,618,7724,7880,7881,7882].includes(i)?r.push(t.toLower?"i":"I"):[308,309,584,567,7434,8465].includes(i)?r.push(t.toLower?"j":"J"):[408,488,7435,7728,7730,7731,7732,42928].includes(i)?r.push(t.toLower?"k":"K"):[313,315,317,319,321,671,7436,7734,7738,7740,8514,8515,11362,42925].includes(i)?r.push(t.toLower?"l":"L"):[7437,7742,7744,7746,8499,11374].includes(i)?r.push(t.toLower?"m":"M"):[209,323,325,327,413,504,544,628,7438,7748,7750,7752,7754,8469].includes(i)?r.push(t.toLower?"n":"N"):[210,211,212,213,214,332,334,336,415,416,465,524,526,558,7884,7886].includes(i)?r.push(t.toLower?"o":"O"):[420,7764,7766,8473].includes(i)?r.push(t.toLower?"p":"P"):[490,491,8474,8506].includes(i)?r.push(t.toLower?"q":"Q"):[340,342,344,422,528,530,640,641,588,7449,7450,694,7768,7770,7774,8475,8476,8477,11364].includes(i)?r.push(t.toLower?"r":"R"):[346,348,350,352,536,7776,7778,11390].includes(i)?r.push(t.toLower?"s":"S"):[354,356,358,428,430,538,574,7786,7788,7790,7792,42929].includes(i)?r.push(t.toLower?"t":"T"):[217,218,219,220,360,362,364,366,368,431,467,532,534,7794,7796,7798,7908,7910].includes(i)?r.push(t.toLower?"u":"U"):[7804,7805,7806].includes(i)?r.push(t.toLower?"v":"V"):[412,372,7808,7809,7810,7811,7812,7813,7814,7815,7816,7817].includes(i)?r.push(t.toLower?"w":"W"):[7818,7820].includes(i)?r.push(t.toLower?"x":"X"):[221,370,374,376,562,590,7822,7922,7924,7926,7928,8516].includes(i)?r.push(t.toLower?"y":"Y"):[377,379,381,437,548,7824,7826,7828,8484,11391].includes(i)&&r.push(t.toLower?"z":"Z")}}return r.join("")}plural(e,t){if(void 0!==t&&1===t||this._uncountable.indexOf(e.toLowerCase())>=0)return e;for(let t in this._irregular){let r=RegExp(`${t}$`,"i"),n=this._irregular[t];if(r.test(e))return e.replace(r,n)}for(let t in this._plural){let r=RegExp(t,"i");if(r.test(e))return e.replace(r,this._plural[t])}return e}singular(e,t){if(void 0!==t&&1!==t||this._uncountable.indexOf(e.toLowerCase())>=0)return e;for(let t in this._irregular){let r=RegExp(`${this._irregular[t]}$`,"i");if(r.test(e))return e.replace(r,t)}for(let t in this._singular){let r=RegExp(t,"i");if(r.test(e))return e.replace(r,this._singular[t])}return e}}t.StringHelper=r},7948:function(e,t){var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.TestHelper=t.TestBuilder=t.TestSuiteBuilder=void 0;class n{constructor(e,t,r){this.utils=e,this.fs=t,this.obj=r,this.tests=[]}add(e){return this.tests.push(e),this}build(e){return r(this,void 0,void 0,function*(){for(let t of this.tests){let r=yield this.buildSuite(t.build());yield this.fs.write(`${e}/${r.name}.json`,JSON.stringify(r,null,2))}})}buildSuite(e){return r(this,void 0,void 0,function*(){let t={name:e.name,context:this.obj.clone(e.context),cases:[],errors:0};for(let r of e.cases){let n={name:r.name,tests:[],errors:0},i=0;for(let t of r.tests)try{if(this.utils.isAsync(r.func)){let i=yield r.func(t,e.context);n.tests.push({test:t,result:i})}else{let i=r.func(t,e.context);n.tests.push({test:t,result:i})}}catch(e){i++,n.tests.push({test:t,error:e.toString(),stack:e.stack.toString()})}n.errors=i,t.cases.push(n)}return t.errors=t.cases.reduce((e,t)=>t.errors+e,0),t.errors>0&&console.error(`${t.name} ${t.errors} errors`),t})}}t.TestSuiteBuilder=n;class i{constructor(e,t,r){this.utils=e,this.fs=t,this.str=r,this.tests=[]}add(e){return this.tests.push(e),this}build(e){return r(this,void 0,void 0,function*(){for(let t of this.tests){if(void 0===t.suite&&void 0!==t.source){let e=yield this.fs.read(t.source);if(null==e)throw Error(`${t.source} not found`);t.suite=JSON.parse(e)}if(void 0===t.suite)throw Error("Test suite undefined");let r=this.buildSuite(t.suite,t.template);yield this.fs.write(`${e}/${t.suite.name}.test.ts`,r)}})}buildSuite(e,t){let r=[];for(let n of e.cases){let e=[],i=t.cases.find(e=>e.name===n.name);if(!i){console.warn(`Test template for case ${n.name} not found`);continue}for(let t of n.tests){let r;r=Array.isArray(t.result)?this.str.replace(JSON.stringify(t.result),'"',"'"):"object"==typeof t.result?JSON.stringify(t.result):"string"==typeof t.result?`'${t.result}'`:t.result;let n=this.utils.template(i.template,{result:r,test:t.test.includes("\n")?"`"+t.test+"`":"'"+t.test+"'"});e.push(n)}let s=this.utils.template("      test('${name}', () => {\n${tests}       })\n",{name:n.name,tests:e.join("")});r.push(s)}let n=this.utils.template("describe('${name}', () => {\n     const context = JSON.parse('${context}')\n${cases}})\n",{name:e.name,context:void 0!==e.context?JSON.stringify(e.context):"{}",cases:r.join("")});return`${t.header}